(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[21],{6928:function(t,s,a){"use strict";a.r(s);var e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("q-page",[t.$q.platform.is.mobile?t._e():a("payments-desktop"),t.$q.platform.is.mobile?a("payments-mobile"):t._e()],1)},i=[],n=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("q-page",[a("page-loader",{attrs:{state:t.pageIsLoad}}),a("q-dialog",{attrs:{persistent:"",maximized:t.$q.screen.lt.sm},on:{hide:t.onHidePayDialog},model:{value:t.dialogPay,callback:function(s){t.dialogPay=s},expression:"dialogPay"}},[a("pay-dialog",{attrs:{widget_uri:t.dialogPayWidgetUri}})],1),a("q-dialog",{attrs:{maximized:t.$q.screen.lt.sm},model:{value:t.dialogAddedPhoneOrEmail,callback:function(s){t.dialogAddedPhoneOrEmail=s},expression:"dialogAddedPhoneOrEmail"}},[a("q-card",[a("q-card-section",{staticClass:"row full-width justify-center items-center",staticStyle:{"font-family":"'Vox-MI'","font-size":"18px"}},[t._v("\n          Укажите email/телефон для получения чека об оплате.\n         ")]),a("q-card-section",{staticClass:"row items-center"},[a("div",{staticClass:"col q-pr-sm q-pl-sm"},[a("q-input",{staticClass:"input50h",attrs:{rounded:"",outlined:"",placeholder:"Email"},model:{value:t.email,callback:function(s){t.email=s},expression:"email"}})],1),a("div",{staticClass:"col-auto"},[t._v("или")]),a("div",{staticClass:"col q-pr-sm q-pl-sm"},[a("q-input",{staticClass:"input50h",attrs:{rounded:"",outlined:"",mask:t.maskphone,placeholder:"Телефон"},model:{value:t.phone,callback:function(s){t.phone=s},expression:"phone"}})],1)]),a("q-card-section",{staticClass:"row"},[a("q-space"),a("div",[a("q-btn",{staticClass:"btn-orange",attrs:{flat:"","no-caps":""},on:{click:function(s){return t.preSaleCheck()}}},[a("span",{staticClass:"btn-title"},[t._v("Продолжить")])])],1)],1)],1)],1),a("div",{staticClass:"row items-center head-page",staticStyle:{"padding-bottom":"20px"}},[a("span",{staticClass:"subtitle self-end"},[t._v("Оплаты")]),a("q-space"),a("q-btn",{attrs:{dense:"",flat:"","no-caps":"",rounded:"",to:"/payments-history"}},[a("q-icon",{attrs:{name:"img:icons/Linkk_PaymentHistory.svg",size:"20px"}}),a("span",{staticClass:"font-sspro-sr fs-14 text-accent q-pl-sm"},[t._v("История оплат")])],1)],1),a("div",{staticClass:"content-page"},[a("div",{staticClass:"row payments"},[a("div",{staticClass:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 q-pa-sm"},[a("q-card",{staticClass:"card-shadow fit"},[a("q-card-section",{staticClass:"q-pa-none"},[a("div",{staticClass:"payment-categories-item-main-title"},[t._v("Автошкола:")])]),t.userSchool?t._e():a("q-card-section",{staticClass:"payments-card-content q-pa-none"},[a("div",{staticClass:"fit flex flex-center"},[a("div",{staticClass:"full-width text-center"},[a("img",{attrs:{src:"img/Payment_Sale.jpg",alt:""}}),a("div",{staticClass:"payment-categories-item-main-card-title"},[t._v("\n                    Вы не записаны в"),a("br"),t._v("автошколу на обучение\n                  ")]),a("div",{staticClass:"payment-categories-item-main-card-subtitle"},[t._v("\n                    Чтобы пройти обучение, нужно выбрать автошколу"),a("br"),t._v("и записаться.\n                  ")])])])]),t.userSchool?a("q-card-section",{staticClass:"payments-card-content q-pa-none"},[a("div",{staticClass:"fit flex flex-center"},[a("div",{staticClass:"full-width text-center"},[a("img",{attrs:{src:"img/Payment_Sale.jpg",alt:""}}),a("div",{staticClass:"payment-categories-item-main-card-title",staticStyle:{"margin-bottom":"0"}},[t._v("\n                    Вы записаны в автошколу:\n                  ")]),a("div",{staticClass:"payment-categories-item-main-card-title text-accent",staticStyle:{"margin-top":"0"}},[t._v("\n                    "+t._s(t.userSchool.title)+"\n                  ")]),a("q-separator"),a("q-list",{attrs:{separator:""}},[a("q-item",{staticClass:"q-pa-none"},[a("q-item-section",{staticClass:"text-right"},[a("q-item-label",{staticClass:"font-sspro-sr fs-14 price-title"},[t._v("\n                          Сумма покупок:\n                        ")])],1),a("q-item-section",{staticClass:"text-left fs-20 q-pl-lg"},[a("q-item-label",[t._v("\n                          "+t._s(t.numberWithSpaces(t.summ.acc_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])])],1)],1),a("q-item",{staticClass:"q-pa-none"},[a("q-item-section",{staticClass:"text-right"},[a("q-item-label",{staticClass:"font-sspro-sr fs-14 price-title"},[t._v("\n                          Сумма оплат:\n                        ")])],1),a("q-item-section",{staticClass:"text-left fs-20 q-pl-lg"},[a("q-item-label",[t._v("\n                          "+t._s(t.numberWithSpaces(t.summ.paid_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])])],1)],1),a("q-item",{staticClass:"q-pa-none"},[a("q-item-section",{staticClass:"text-right"},[a("q-item-label",{staticClass:"font-sspro-sr fs-14 price-title"},[t._v("\n                          Сумма задолжености:\n                        ")])],1),a("q-item-section",{staticClass:"text-left fs-20 q-pl-lg"},[a("q-item-label",[t._v("\n                          "+t._s(t.numberWithSpaces(t.summ.debt_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])])],1)],1),t.summ.past_debt_amount>0?a("q-item",{staticClass:"q-pa-none"},[a("q-item-section",{staticClass:"text-right"},[a("q-item-label",{staticClass:"font-sspro-sr fs-14 price-title"},[a("q-icon",{staticClass:"q-mr-xs",attrs:{name:"img:icons/warning.svg",size:"16px"}}),t._v(" Сумма просроченых платежей:\n                        ")],1)],1),a("q-item-section",{staticClass:"text-left fs-20 q-pl-lg"},[a("q-item-label",[t._v("\n                          "+t._s(t.numberWithSpaces(t.summ.past_debt_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])])],1)],1):t._e()],1)],1)])]):t._e(),t.salesList&&0==t.salesList.length?a("q-card-section",{staticClass:"row items-center justify-center"},[a("q-btn",{staticClass:"btn-orange",attrs:{flat:"","no-caps":"",to:"/payments/record-school/1"}},[a("q-icon",{attrs:{name:"img:icons/Button_SaleSignup.svg",size:"20px"}}),a("span",{staticClass:"btn-title"},[t._v(t._s(t.userHasSchool?"Выбрать тариф":"Записаться в автошколу"))])],1)],1):t._e(),a("q-card-section",{staticClass:"row items-center full-width"},[t.salesList&&1==t.salesList.length?a("div",{staticClass:"row items-center full-width"},[a("div",{staticClass:"col-auto font-sspro-sr fs-14 row items-center q-pl-md"},[t._v("\n                Сумма оплаты:\n              ")]),a("div",{staticClass:"col q-pr-sm q-pl-sm"},[a("q-input",{staticClass:"input50h",attrs:{rounded:"",outlined:"",placeholder:"—"},model:{value:t.amount,callback:function(s){t.amount=s},expression:"amount"}})],1),a("div",{staticClass:"col-auto"},[a("q-btn",{staticClass:"btn-orange",attrs:{flat:"","no-caps":"",disable:!t.amount||0==t.amount},on:{click:function(s){return t.preSaleCheck()}}},[a("q-icon",{attrs:{name:"img:icons/Button_Payments.svg",size:"20px"}}),a("span",{staticClass:"btn-title"},[t._v("Внести платеж")])],1)],1)]):t._e(),t.salesList.length>1?a("div",{staticClass:"text-center full-width"},[a("q-btn",{staticClass:"btn-orange",attrs:{flat:"","no-caps":"",to:"/payments-detail"}},[a("q-icon",{attrs:{name:"img:icons/Button_Payments.svg",size:"20px"}}),a("span",{staticClass:"btn-title"},[t._v("Подробнее")])],1)],1):t._e()])],1)],1),a("div",{staticClass:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 q-pa-sm"},[t.coursesPurched&&0==t.coursesPurched.length||t.underConsrtaction?a("q-card",{staticClass:"card-shadow fit"},[a("q-card-section",{staticClass:"q-pa-none"},[a("div",{staticClass:"payment-categories-item-main-title"},[t._v("Онлайн-курсы:")])]),a("q-card-section",{staticClass:"payments-card-content q-pa-none"},[a("div",{staticClass:"fit flex flex-center"},[a("div",{staticClass:"full-width text-center"},[a("img",{attrs:{src:"img/Payment_Cources.jpg",alt:""}}),a("div",{staticClass:"payment-categories-item-main-card-title"},[t._v("\n                    У вас нет купленных"),a("br"),t._v("онлайн-курсов\n                  ")]),a("div",{staticClass:"payment-categories-item-main-card-subtitle"},[t._v("\n                    Купите онлайн-курс для определенной "),a("br"),t._v(" категории водительских прав.\n                  ")])])])]),a("q-card-section",{staticClass:"row items-center justify-center"},[t.underConsrtaction?t._e():a("q-btn",{staticClass:"btn-orange",attrs:{flat:"","no-caps":"",to:"/payments/buy-courses/1"}},[a("q-icon",{attrs:{name:"img:icons/Button_Buy.svg",size:"20px"}}),a("span",{staticClass:"btn-title"},[t._v("Купить онлайн-курс")])],1)],1)],1):t._e(),t.coursesPurched&&t.coursesPurched.length>0&&!t.underConsrtaction?a("div",{staticClass:"column fit"},[t._l(t.coursesPurched,(function(s){return a("div",{staticClass:"col-4 buy-purchased-course"},[a("q-card",{staticClass:"card-shadow fit column"},[a("q-card-section",{staticClass:"col row gradient-grey"},[a("div",{staticClass:"col row items-center"},[a("q-item",[a("q-item-section",[a("q-item-label",[a("span",{staticClass:"title-purchased-card"},[t._v("Онлайн-курс: "),a("span",{staticClass:"text-accent"},[t._v("Категория "+t._s(s.category.toUpperCase()))])])]),a("q-item-label",{staticClass:"font-sspro-sr fs-15",attrs:{caption:""}},[t._v("\n                          Тип обучения: "),a("b",[t._v(t._s("s"==s.study_type?"Пошаговое":"Все уроки"))])])],1)],1)],1),a("div",{staticClass:"col-auto"},[a("q-icon",{attrs:{name:"img:icons/Payment_"+s.category.toUpperCase()+"_G.svg",size:"72px"}})],1),a("div",{staticClass:"col-auto row items-center category-big"},[t._v("\n                    "+t._s(s.category.toUpperCase())+"\n                  ")])]),a("q-separator"),a("q-card-section",{staticClass:"row col"},[a("div",{staticClass:"col-shrink row items-center"},[a("q-item",[a("q-item-section",[a("q-item-label",{staticClass:"font-sspro-sr fs-15"},[t._v("\n                          Курс доступен до:\n                        ")]),a("q-item-label",{staticClass:"font-sspro-sr fs-18",attrs:{caption:""}},[t._v("\n                          "+t._s(t.dateFormat(s.end_date))+"\n                        ")])],1)],1)],1),a("div",{staticClass:"col row items-center"},[a("q-item",[a("q-item-section",[a("q-item-label",{staticClass:"font-sspro-sr fs-15"},[t._v("\n                          Статистика доступна до:\n                        ")]),a("q-item-label",{staticClass:"font-sspro-sr fs-18",attrs:{caption:""}},[t._v("\n                          "+t._s(t.dateFormat(s.end_date))+"\n                        ")])],1)],1)],1),a("div",{staticClass:"col-auto row items-center"},[a("q-btn",{staticClass:"btn-orange",attrs:{flat:"","no-caps":"",to:"/payments/buy-courses/1?category="+s.category}},[a("q-icon",{attrs:{name:"img:icons/Button_Prolong.svg",size:"20px"}}),a("span",{staticClass:"btn-title"},[t._v("Продлить")])],1)],1)])],1)],1)})),t._l(t.notPurshedCourses,(function(s){return a("div",{staticClass:"col-4 buy-purchased-course"},[a("q-card",{staticClass:"card-shadow fit transparent border-dasahed"},[a("q-card-section",{staticClass:"row items-center fit"},[a("div",{staticClass:"col text-center "},[a("div",{staticClass:"title-purchased-card full-width"},[t._v("Онлайн-курс: Категория "+t._s(s.toUpperCase()))]),a("q-btn",{staticClass:"btn-orange q-mt-md",attrs:{flat:"","no-caps":"",to:"/payments/buy-courses/1?category="+s}},[a("q-icon",{attrs:{name:"img:icons/Button_Buy.svg",size:"20px"}}),a("span",{staticClass:"btn-title"},[t._v("Купить")])],1)],1)])],1)],1)}))],2):t._e()],1)])])],1)},o=[],l=(a("7db0"),a("e260"),a("d3b7"),a("e6cf"),a("ac1f"),a("3ca3"),a("1276"),a("ddb0"),a("6374")),c=a.n(l),r=a("ded3"),d=a.n(r),m=(a("bc3a"),a("cf91")),p=a("2f62"),u=a("c1df"),f=a.n(u),C=(a("957c"),a("9f3a")),h={name:"Payments",components:{PayDialog:m["a"],PageLoader:C["a"]},data:function(){return{pageIsLoad:!1,amount:"",dialogPay:!1,dialogPayWidgetUri:null,dialogAddedPhoneOrEmail:!1,underConsrtaction:!1,email:null,phone:null}},methods:d()(d()({},Object(p["b"])(["getSales","getCoursesPurched","paySale","getUserSchool"])),{},{dateFormat:function(t){return f()(t).format("LL").split(" г.")[0]},onHidePayDialog:function(){var t=this;this.getSales({}).then((function(s){t.amount="",t.email="",t.phone=""}))},preSaleCheck:function(){this.phone||this.email?(this.dialogAddedPhoneOrEmail=!1,this.saleOneAdded()):this.dialogAddedPhoneOrEmail=!0},saleOneAdded:function(){var t=this,s={amount:this.amount,sale_id:this.salesList[0].id};this.phone&&(s.phone=this.phone),this.email&&(s.email=this.email),this.paySale(s).then((function(s){if(s.status>=400)return("invalid"==s.data.errors[0].code&&"phone"==s.data.errors[0].field||"email"==s.data.errors[0].field)&&(t.dialogAddedPhoneOrEmail=!0),void t.$q.notify({icon:"warning",message:s.data.errors[0].message,timeout:3e3,color:"blue-grey-10",html:!0,position:"top"});t.dialogPayWidgetUri=s.data.widget_uri,t.dialogPay=!0}))},initDataPage:function(){var t=this;this.pageIsLoad=!0,this.email=this.userInfo.email,this.phone=this.userInfo.phone,this.userSchool=null;var s=this.getSales({}),a=this.getCoursesPurched({}),e=this.getUserSchool({});Promise.all([s,a,e]).then((function(s){t.pageIsLoad=!1}))}}),computed:d()(d()({},Object(p["c"])(["salesList","coursesPurched","userInfo","userCategories"])),{},{summ:function(){var t,s=0,a=0,e=0,i=0,n=c()(this.salesList);try{for(n.s();!(t=n.n()).done;){var o=t.value;s+=parseFloat(o.acc_amount),a+=parseFloat(o.paid_amount),e+=parseFloat(o.debt_amount),i+=parseFloat(o.past_debt_amount)}}catch(l){n.e(l)}finally{n.f()}return{acc_amount:s,paid_amount:a,debt_amount:e,past_debt_amount:i}},mainSale:function(){return _.find(this.salesList,(function(t){return t.tariff.is_main}))},notPurshedCourses:function(){var t,s=[],a=c()(this.categoriesAll);try{for(a.s();!(t=a.n()).done;){var e=t.value;_.find(this.coursesPurched,{category:e})||s.push(e)}}catch(i){a.e(i)}finally{a.f()}return s}}),watch:{userInfo:function(t){this.initDataPage()}},mounted:function(){this.userInfo&&this.initDataPage()}},v=h,g=a("2877"),q=a("9989"),b=a("24e8"),y=a("f09f"),x=a("a370"),P=a("27f9"),w=a("2c91"),S=a("9c40"),L=a("0016"),k=a("eb85"),I=a("1c1c"),Q=a("66e5"),O=a("4074"),j=a("0170"),z=a("eebe"),A=a.n(z),E=Object(g["a"])(v,n,o,!1,null,null,null),F=E.exports;A()(E,"components",{QPage:q["a"],QDialog:b["a"],QCard:y["a"],QCardSection:x["a"],QInput:P["a"],QSpace:w["a"],QBtn:S["a"],QIcon:L["a"],QSeparator:k["a"],QList:I["a"],QItem:Q["a"],QItemSection:O["a"],QItemLabel:j["a"]});var W=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("q-page",[a("page-loader",{attrs:{state:t.pageIsLoad}}),a("q-dialog",{attrs:{persistent:"",maximized:t.$q.screen.lt.sm},on:{hide:t.onHidePayDialog},model:{value:t.dialogPay,callback:function(s){t.dialogPay=s},expression:"dialogPay"}},[a("pay-dialog",{attrs:{widget_uri:t.dialogPayWidgetUri}})],1),a("q-dialog",{model:{value:t.dialogAddedPhoneOrEmail,callback:function(s){t.dialogAddedPhoneOrEmail=s},expression:"dialogAddedPhoneOrEmail"}},[a("q-card",[a("q-card-section",{staticClass:"row full-width justify-center items-center",staticStyle:{"font-family":"'Vox-MI'","font-size":"18px"}},[t._v("\n          Укажите email/телефон для получения чека об оплате.\n         ")]),a("q-card-section",{staticClass:"row items-center"},[a("div",{staticClass:"col-12 q-pr-sm q-pl-sm"},[a("q-input",{staticClass:"input50h",attrs:{rounded:"",outlined:"",placeholder:"Email"},model:{value:t.email,callback:function(s){t.email=s},expression:"email"}})],1),a("div",{staticClass:"col-12 q-pa-md justify-center text-center"},[t._v("или")]),a("div",{staticClass:"col-12 q-pr-sm q-pl-sm"},[a("q-input",{staticClass:"input50h",attrs:{rounded:"",outlined:"",mask:t.maskphone,placeholder:"Телефон"},model:{value:t.phone,callback:function(s){t.phone=s},expression:"phone"}})],1)]),a("q-card-section",{staticClass:"row"},[a("q-space"),a("div",[a("q-btn",{staticClass:"btn-orange",attrs:{flat:"","no-caps":""},on:{click:function(s){return t.preSaleCheck()}}},[a("span",{staticClass:"btn-title"},[t._v("Продолжить")])])],1)],1)],1)],1),a("q-card",{staticClass:"lessons transparent",staticStyle:{"border-radius":"0 !important"},attrs:{flat:""}},[a("q-card-section",{staticClass:"lesson-top relative-position full-width"},[a("div",{staticClass:"row items-center"},[a("div",{staticClass:"col"},[a("div",{staticClass:"row items-center"},[a("div",{staticClass:"col"},[a("div",{staticClass:"lesson-head"},[t._v("Оплаты")])])]),a("div",{staticClass:"row q-mt-xs"},[a("div",{staticClass:"col text-left"},[a("div",{staticClass:"lesson-subtitle"},[t._v("Приобретено курсов: "),a("b",[t._v(t._s(t.coursesPurched.length))])])])])]),a("div",{staticClass:"col-auto"},[a("q-btn",{staticClass:"absolute-top-right full-height row items-center justify-end q-mr-md",attrs:{dense:"",flat:"",stack:"","no-caps":"",to:"/payments-history"}},[a("q-icon",{attrs:{name:"img:icons/Linkk_PaymentHistory.svg",size:"24px"}}),a("span",{staticClass:"font-sspro-sr fs-12 text-accent"},[t._v("История")])],1)],1)])])],1),a("div",{staticClass:"row"}),a("div",{staticClass:"col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-12 q-pa-sm"},[a("q-card",{staticClass:"card-shadow"},[t.salesList&&0==t.salesList.length?a("q-card-section",{staticClass:"q-pa-none"},[a("div",{staticClass:"fit flex flex-center"},[a("div",{staticClass:"full-width text-center"},[a("img",{staticClass:"q-mt-md",attrs:{src:"img/Payment_Sale.jpg",height:"90"}}),a("div",{staticClass:"font-exo2-m fs-20 text-dark q-mt-md"},[t._v("\n                Вы не записаны в"),a("br"),t._v("автошколу на обучение\n              ")]),a("div",{staticClass:"font-sspro-sr fs-12 q-mt-md text-secondary",staticStyle:{"line-height":"1.5"}},[t._v("\n                Чтобы пройти обучение, нужно выбрать автошколу"),a("br"),t._v("и записаться туда, чтобы что-то там.\n              ")])])])]):t._e(),t.salesList&&0==t.salesList.length?a("q-card-section",{staticClass:"row items-center justify-center"},[a("q-btn",{staticClass:"btn-orange-mobile",attrs:{flat:"","no-caps":"",to:"/payments/record-school/1"}},[a("q-icon",{attrs:{name:"img:icons/Button_SaleSignup.svg",size:"20px"}}),a("span",{staticClass:"btn-title"},[t._v("Записаться в автошколу")])],1)],1):t._e()],1),t.salesList&&1==t.salesList.length?a("q-card",{staticClass:"card-shadow"},[a("q-card-section",{staticClass:"payments-card-content q-pa-none"},[a("div",{staticClass:"fit flex flex-center"},[a("div",{staticClass:"full-width text-center"},[a("div",{staticClass:"font-exo2-m fs-20 text-dark q-mt-md"},[t._v("\n                Вы записаны в автошколу:\n              ")]),a("div",{staticClass:"font-exo2-m fs-20 text-accent q-mt-md q-mb-md"},[t._v("\n                  "+t._s(t.userSchool.title)+"\n              ")]),a("q-separator"),a("q-list",{staticClass:"q-pa-none"},[a("q-item",{staticClass:"q-pa-sm"},[a("q-item-section",[a("q-item-label",{staticClass:"font-sspro-sr fs-15 price-title"},[t._v("\n                      "+t._s(t.numberWithSpaces(t.salesList[0].acc_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])]),a("q-item-label",{staticClass:"font-sspro-sr"},[t._v("\n                      Сумма договора\n                    ")])],1),a("q-item-section",[a("q-item-label",{staticClass:"font-sspro-sr fs-15 price-title"},[t._v("\n                      "+t._s(t.numberWithSpaces(t.salesList[0].paid_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])]),a("q-item-label",{staticClass:"font-sspro-sr"},[t._v("\n                      Оплачено\n                    ")])],1),a("q-item-section",[a("q-item-label",{staticClass:"font-sspro-sr fs-15 price-title"},[t._v("\n                      "+t._s(t.numberWithSpaces(t.salesList[0].debt_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])]),a("q-item-label",{staticClass:"font-sspro-sr"},[t._v("\n                      Задолженость\n                    ")])],1)],1),t.salesList[0].past_debt_amount>0?a("q-item",{staticClass:"q-pa-none",staticStyle:{"border-bottom":"solid 1px #F44B2F"}},[a("q-item-section",{staticClass:"past-debt-amount"},[a("q-item-label",{staticClass:"font-exo2-m fs-17"},[a("q-icon",{staticClass:"q-mr-xs",attrs:{name:"img:icons/warning.svg",size:"16px"}}),t._v(" Просрочено:\n                      "+t._s(t.numberWithSpaces(t.salesList[0].past_debt_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])],1)],1)],1):t._e()],1)],1)])]),t.salesList&&t.salesList.length>0?a("q-card-section",{staticClass:"row items-center justify-center"},[a("div",{staticClass:"col q-pr-sm q-pl-sm"},[a("q-input",{staticClass:"input40h",attrs:{rounded:"",outlined:"",placeholder:"Сумма оплаты...","input-class":"fs-15"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-btn",{staticClass:"btn-orange-mobile",class:{"pointer-none":!t.amount||0==t.amount},staticStyle:{left:"15px",width:"155px","z-index":"5",height:"100%"},attrs:{flat:"","no-caps":""},on:{click:function(s){return t.preSaleCheck()}}},[a("span",{staticClass:"font-sspro-sr fs-17"},[t._v("Внести платеж")])])]},proxy:!0}],null,!1,488847668),model:{value:t.amount,callback:function(s){t.amount=s},expression:"amount"}})],1)]):t._e()],1):t._e(),t.salesList&&t.salesList.length>1?a("q-card",{staticClass:"card-shadow"},[a("q-card-section",{staticClass:"payments-card-content q-pa-none"},[a("div",{staticClass:"fit flex flex-center"},[a("div",{staticClass:"full-width text-center"},[a("div",{staticClass:"font-exo2-m fs-20 text-dark q-mt-md"},[t._v("\n                Вы записаны в автошколу:\n              ")]),a("div",{staticClass:"font-exo2-m fs-20 text-accent q-mt-md q-mb-md"},[t._v("\n                 "+t._s(t.userSchool.title)+"\n              ")]),a("q-separator"),a("q-list",{staticClass:"q-pa-none"},[a("q-item",{staticClass:"q-pa-sm"},[a("q-item-section",[a("q-item-label",{staticClass:"font-sspro-sr fs-15 price-title"},[t._v("\n                      "+t._s(t.numberWithSpaces(t.summ.acc_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])]),a("q-item-label",{staticClass:"font-sspro-sr"},[t._v("\n                      Сумма покупок\n                    ")])],1),a("q-item-section",[a("q-item-label",{staticClass:"font-sspro-sr fs-15 price-title"},[t._v("\n                      "+t._s(t.numberWithSpaces(t.summ.paid_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])]),a("q-item-label",{staticClass:"font-sspro-sr"},[t._v("\n                      Сумма оплат\n                    ")])],1),a("q-item-section",[a("q-item-label",{staticClass:"font-sspro-sr fs-15 price-title"},[t._v("\n                      "+t._s(t.numberWithSpaces(t.summ.debt_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])]),a("q-item-label",{staticClass:"font-sspro-sr"},[t._v("\n                      Долг\n                    ")])],1)],1),t.summ.past_debt_amount>0?a("q-item",{staticClass:"q-pa-none",staticStyle:{"border-bottom":"solid 1px #F44B2F"}},[a("q-item-section",{staticClass:"past-debt-amount"},[a("q-item-label",{staticClass:"font-exo2-m fs-17"},[a("q-icon",{staticClass:"q-mr-xs",attrs:{name:"img:icons/warning.svg",size:"16px"}}),t._v(" Просрочено:\n                      "+t._s(t.numberWithSpaces(t.summ.past_debt_amount))+" "),a("span",{staticClass:"currency"},[t._v("Р")])],1)],1)],1):t._e()],1)],1)])]),a("q-card-section",{staticClass:"row items-center justify-center"},[a("q-btn",{staticClass:"btn-orange-mobile",attrs:{flat:"","no-caps":"",to:"/payments-detail"}},[a("span",{staticClass:"font-sspro-sr fs-17"},[t._v("Подробнее")])])],1)],1):t._e()],1),a("div",{staticClass:"col q-pa-sm"},[t.coursesPurched&&0==t.coursesPurched.length||t.underConsrtaction?a("q-card",{staticClass:"card-shadow"},[a("q-card-section",{staticClass:"q-pa-none"},[a("div",{staticClass:"fit flex flex-center"},[a("div",{staticClass:"full-width text-center"},[a("img",{staticClass:"q-mt-md",attrs:{src:"img/pcm.png",height:"90"}}),a("div",{staticClass:"font-exo2-m fs-20 text-dark q-mt-md q-pb-md"},[t._v("\n             У вас нет купленных"),a("br"),t._v("онлайн-курсов\n             ")]),a("div",{staticClass:"font-sspro-sr fs-12 q-mt-md text-secondary",staticStyle:{"line-height":"1.5"}},[t._v("\n                Купите онлайн-курс для определенной "),a("br"),t._v(" категории водительских прав.\n              ")])])])]),a("q-card-section",{staticClass:"row items-center justify-center"},[a("q-btn",{staticClass:"btn-orange-mobile full-width",attrs:{flat:"","no-caps":"",to:"/payments/buy-courses/1"}},[a("q-icon",{attrs:{name:"img:icons/mobile_btn_add.svg",size:"16px"}}),a("span",{staticClass:"btn-title"},[t._v("Купить онлайн-курс")])],1)],1)],1):t._e(),t.underConsrtaction?t._e():a("div",{staticClass:"courses-paid-list"},t._l(t.coursesPurched,(function(s){return a("div",{staticClass:"course-paid-item"},[a("div",{staticClass:"title"},[t._v("Онлайн-курс: "),a("span",{staticClass:"text-accent"},[t._v("Категория "+t._s(s.category.toUpperCase()))])]),a("div",{staticClass:"row q-mt-sm"},[a("div",{staticClass:"col item"},[a("span",[t._v("Пошагшовое"),a("br"),t._v("обучение")])]),a("div",{staticClass:"col item"},[a("span",[a("span",{staticClass:"text-secondary"},[t._v("Доступен до:")]),a("br"),t._v(t._s(t.dateFormat(s.end_date)))])]),a("div",{staticClass:"col item"},[a("span",[a("span",{staticClass:"text-secondary"},[t._v("Статистика до:")]),a("br"),t._v(t._s(t.dateFormat(s.end_date)))])]),a("div",{staticClass:"col"},[a("div",{staticClass:"row items-center justify-center icon"},[a("q-icon",{attrs:{name:"img:icons/Payment_"+s.category.toUpperCase()+"_G.svg",size:"50px"}})],1),a("div",{staticStyle:{position:"absolute",bottom:"-2px",right:"-2px"}},[a("q-btn",{staticClass:"btn-orange-mobile ",attrs:{flat:"","no-caps":"",to:"/payments/buy-courses/1?category="+s.category}},[a("span",{staticClass:"btn-title"},[t._v("Продлить")])])],1)])])])})),0)],1)],1)},U=[],B=a("1d9f"),D={name:"Payments",components:{PayDialog:m["a"],Categories:B["a"],PageLoader:C["a"]},data:function(){return{pageIsLoad:!1,amount:"",dialogPay:!1,dialogPayWidgetUri:null,dialogAddedPhoneOrEmail:!1,underConsrtaction:!1,email:null,phone:null}},methods:d()(d()({},Object(p["b"])(["getSales","getCoursesPurched","paySale","getUserSchool"])),{},{dateFormat:function(t){return f()(t).format("ll").split(" г.")[0]},onHidePayDialog:function(){var t=this;this.getSales({}).then((function(s){t.amount="",t.email="",t.phone=""}))},preSaleCheck:function(){this.phone||this.email?(this.dialogAddedPhoneOrEmail=!1,this.saleOneAdded()):this.dialogAddedPhoneOrEmail=!0},saleOneAdded:function(){var t=this,s={amount:this.amount,sale_id:this.salesList[0].id};this.phone&&(s.phone=this.phone),this.email&&(s.email=this.email),this.paySale(s).then((function(s){if(s.status>=400)return("invalid"==s.data.errors[0].code&&"phone"==s.data.errors[0].field||"email"==s.data.errors[0].field)&&(t.dialogAddedPhoneOrEmail=!0),void t.$q.notify({icon:"warning",message:s.data.errors[0].message,timeout:3e3,color:"blue-grey-10",html:!0,position:"top"});t.dialogPayWidgetUri=s.data.widget_uri,t.dialogPay=!0}))}}),computed:d()(d()({},Object(p["c"])(["salesList","coursesPurched","userInfo","userCategories"])),{},{notPurshedCourses:function(){var t,s=[],a=c()(this.categoriesAll);try{for(a.s();!(t=a.n()).done;){var e=t.value;_.find(this.coursesPurched,{category:e})||s.push(e)}}catch(i){a.e(i)}finally{a.f()}return s},mainSale:function(){return _.find(this.salesList,(function(t){return t.tariff.is_main}))},summ:function(){var t,s=0,a=0,e=0,i=0,n=c()(this.salesList);try{for(n.s();!(t=n.n()).done;){var o=t.value;s+=parseFloat(o.acc_amount),a+=parseFloat(o.paid_amount),e+=parseFloat(o.debt_amount),i+=parseFloat(o.past_debt_amount)}}catch(l){n.e(l)}finally{n.f()}return{acc_amount:s,paid_amount:a,debt_amount:e,past_debt_amount:i}}}),mounted:function(){var t=this;this.pageIsLoad=!0,this.userSchool=null;var s=this.getSales({}),a=this.getCoursesPurched({}),e=this.getUserSchool({});Promise.all([s,a,e]).then((function(s){t.pageIsLoad=!1,t.email=t.userInfo.email,t.phone=t.userInfo.phone}))}},$=D,H=Object(g["a"])($,W,U,!1,null,null,null),M=H.exports;A()(H,"components",{QPage:q["a"],QDialog:b["a"],QCard:y["a"],QCardSection:x["a"],QInput:P["a"],QSpace:w["a"],QBtn:S["a"],QIcon:L["a"],QSeparator:k["a"],QList:I["a"],QItem:Q["a"],QItemSection:O["a"],QItemLabel:j["a"]});var G={name:"Payments",components:{PaymentsDesktop:F,PaymentsMobile:M}},J=G,V=Object(g["a"])(J,e,i,!1,null,null,null);s["default"]=V.exports;A()(V,"components",{QPage:q["a"]})}}]);