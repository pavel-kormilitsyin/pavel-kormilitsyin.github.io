(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{"291a":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("q-page",[t.$q.platform.is.mobile?t._e():e("payments-buy-courses-desktop"),t.$q.platform.is.mobile?e("payments-buy-courses-mobile"):t._e()],1)},r=[],i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("q-page",{staticClass:"buy-courses"},[e("page-loader",{attrs:{state:t.pageIsLoad}}),e("q-dialog",{model:{value:t.dialogChangeStudyType,callback:function(s){t.dialogChangeStudyType=s},expression:"dialogChangeStudyType"}},[t.currentCourse&&t.currentStudyTypeLabel?e("q-card",[e("q-card-section",{staticClass:"dialog-header",attrs:{align:"center"}},[t._v("\n      Внимание!\n    ")]),e("q-card-section",{staticStyle:{"font-size":"18px","line-height":"1.2"},attrs:{align:"center"}},[t._v("\n      У Вас есть купленный курс по \n      по "+t._s(t.getNoun(1==t.currentCourse.categories.length?t.currentCourse.categories.length:t.purchedCoursesLiters.length,"категории","категориям","категориям"))+"\n      "),e("span",{staticClass:"text-uppercase text-bold"},[t._v(t._s(1==t.currentCourse.categories.length?t.currentCourse.categories.join(", "):t.purchedCoursesLiters.join(", ")))]),e("br"),1==t.currentCourse.categories.length?e("span",[t._v("в режиме "),e("b",[t._v('"'+t._s(t.currentStudyTypeLabel)+'"')])]):t._e(),e("br"),e("br"),t._v("\n      Вам необходимо выбрать режим"),e("br"),t._v("  \n      дальнейшей работы по  "+t._s(t.getNoun(t.currentCourse.categories.length,"категории","категориям","категориям"))+" "),e("span",{staticClass:"text-uppercase text-bold"},[t._v(t._s(t.currentCourse.categories.join(", ")))])]),e("q-card-section",{attrs:{align:"center"}},t._l(t.types,(function(s){return e("q-btn",{key:s.value,staticClass:"btn-orange q-ma-xs",attrs:{"no-caps":"",flat:"",rounded:""},on:{click:function(e){t.dataPay.study_type=t.currentStudyTypeValue=s.value,t.prepearePay()}}},[e("span",{staticClass:"btn-title"},[t._v(t._s(s.label))])])})),1)],1):t._e()],1),e("div",{staticClass:"row items-center head-page",staticStyle:{"padding-bottom":"20px"}},[1==t.$route.params.step?e("span",{staticClass:"subtitle self-end"},[t._v("Выберите курс")]):t._e(),2==t.$route.params.step?e("span",{staticClass:"subtitle self-end"},[t._v("Оплата")]):t._e(),e("q-space"),e("q-btn",{staticClass:"btn-white row items-center q-ml-lg",attrs:{"no-caps":"",flat:"",to:"/payments"}},[e("q-icon",{attrs:{name:"img:icons/Cancel_R.svg",size:"16px"}}),e("span",{staticClass:"q-ml-md"},[t._v("Отменить")])],1)],1),1==t.$route.params.step?e("div",{staticClass:"content-page"},[e("div",{staticClass:"swiper-slides"},[e("swiper",{ref:"swiperSchools",staticClass:"swiper fit",attrs:{options:t.swiperOptionSchools}},t._l(t.coursesList,(function(s,a){return e("swiper-slide",{key:s.id},[e("div",{staticClass:"col q-pa-xs cursor-pointer",on:{click:function(e){t.currentCourse=s}}},[e("q-card",{staticClass:"card-shadow course-buy",class:{selected:s==t.currentCourse}},[e("q-card-section",{attrs:{align:"center"}},[e("div",{staticStyle:{height:"80px",width:"150px","background-repeat":"no-repeat","background-position":"bottom center"},style:{"background-image":"url(icons/Payment_"+(1==s.categories.length?s.categories.join("").toUpperCase():"ABC")+"_"+(t.currentCourse==s?"R":"G")+".svg)"}})]),e("q-card-section",{staticClass:"title-buy-course fs-24",attrs:{align:"center"}},[t._v("\n              "+t._s(s.title)+"\n            ")]),e("q-card-section",{attrs:{align:"center"}},[e("q-separator"),e("q-list",{attrs:{separator:""}},t._l(3,(function(a){return e("q-item",{key:a},[e("q-item-section",[e("div",{staticClass:"row items-center justify-start"},[e("div",{staticClass:"col-auto font-sspro-sr ellipsis text-right",staticStyle:{width:"100px"}},[t._v("\n                    "+t._s(t.tariffText[a-1])+"\n                  ")]),e("div",{staticClass:"col fs-20 q-pl-lg ellipsis"},[t._v("\n                    "+t._s(s["cost"+a])+" "),e("span",{staticClass:"currency"},[t._v("Р")])])])])],1)})),1)],1)],1)],1)])})),1),e("div",{staticClass:"swiper-scrollbar",staticStyle:{"margin-top":"10px"},attrs:{slot:"scrollbar"},slot:"scrollbar"}),e("div",{staticClass:"left-arrow",attrs:{slot:"button-prev"},slot:"button-prev"},[e("img",{attrs:{src:"icons/Arrow_Small.svg",alt:""}})]),e("div",{staticClass:"right-arrow",attrs:{slot:"button-next"},slot:"button-next"},[e("img",{attrs:{src:"icons/Arrow_Small.svg",alt:""}})])],1),t.currentCourse?e("div",{staticClass:"font-vox-mi fs-20 q-mt-md q-mb-md"},[t._v("\n        Оформление покупки: "),e("span",{staticClass:"text-secondary"},[t._v(t._s(t.currentCourse.title))])]):t._e(),e("q-card",{staticClass:"card-shadow"},[e("q-card-section",{staticClass:"row items-center"},[e("div",{staticClass:"col q-pa-sm"},[e("dropdown",{attrs:{title:"Выберите срок обучения",value:t.dataPay.duration,options:t.durations},on:{update:function(s){t.dataPay.duration=s}}})],1),e("div",{staticClass:"col q-pa-sm"},[e("dropdown",{attrs:{title:"Выберите режим обучения",value:t.dataPay.study_type,options:t.types},on:{update:function(s){t.dataPay.study_type=s}}})],1),e("div",{staticClass:"col q-pa-sm"},[e("div",{staticClass:"q-pl-lg font-sspro-sr q-pa-sm fs-15"},[t._v("Введите промокод")]),e("q-input",{staticClass:"input50h",attrs:{rounded:"",outlined:""},model:{value:t.dataPay.promo,callback:function(s){t.$set(t.dataPay,"promo",s)},expression:"dataPay.promo"}})],1),e("div",{staticClass:"col self-end q-pa-sm"},[e("q-btn",{staticClass:"q-mb-sm",attrs:{"no-caps":"",flat:"",disable:!t.dataPay.promo},on:{click:function(s){return t.applyDiscount()}}},[e("q-icon",{attrs:{name:"img:icons/Apply_Promo.svg",size:"16px"}}),e("span",{staticClass:"q-ml-sm font-sspro-sr fs-15 text-accent"},[t._v("Применить")])],1)],1)]),e("q-card-section",{staticClass:"q-pl-lg font-sspro-sr q-pa-sm fs-15"},[e("q-banner",{staticStyle:{background:"#f0f1f7"},attrs:{rounded:""},scopedSlots:t._u([{key:"avatar",fn:function(){return[e("div",{staticClass:"row"},[e("div",{staticClass:"col-auto q-pr-sm"},[e("q-icon",{attrs:{name:"img:icons/info.svg"}})],1),e("div",{staticClass:"col",staticStyle:{"line-height":"1.5"}},[t._v("\n                  При выборе режима обучения “Открыть все уроки” у вас будет доступ ко всем урокам. Вы сможете просматривать их в любом порядке. При выборе «Пошаговое обучение» у вас будет открыт только один урок. Чтобы получить доступ к следующему, вам будет необходимо просмотреть урок полностью от начала до конца, а также сдать зачет по пройденной теме (при просмотре урока в первый раз перемотка не будет работать).\n                ")])])]},proxy:!0}],null,!1,162851223)})],1),t.currentCourse?e("q-card-section",{staticClass:"row items-center"},[e("div",{staticClass:"col-auto"},[e("q-item",[e("q-item-section",[e("q-item-label",{staticClass:"fs-20 text-secondary"},[t._v("Стоимость")]),e("q-item-label",{staticClass:"fs-32 text-dark"},[t._v(" "+t._s(t.numberWithSpaces(t.summ))+" "),e("span",{staticClass:"currency"},[t._v("Р")])])],1)],1)],1),e("div",{staticClass:"col-auto q-pl-md"},[e("q-item",[e("q-item-section",[e("q-item-label",{staticClass:"fs-20 text-secondary"},[t._v("Скидка")]),e("q-item-label",{staticClass:"fs-32 text-dark"},[t._v("0 "),e("span",{staticClass:"currency"},[t._v("Р")])])],1)],1)],1),e("div",{staticClass:"col-auto q-pl-md"},[e("q-item",[e("q-item-section",[e("q-item-label",{staticClass:"fs-20 text-secondary"},[t._v("Итого к оплате")]),e("q-item-label",{staticClass:"fs-32 text-dark ellipsis"},[t._v(t._s(t.numberWithSpaces(t.summ))+" "),e("span",{staticClass:"currency"},[t._v("Р")])])],1)],1)],1),e("q-space"),e("q-btn",{staticClass:"btn-orange",attrs:{"no-caps":"",flat:"",rounded:"",loading:t.prepeareLoading},on:{click:function(s){return t.prepearePay()}}},[e("q-icon",{attrs:{name:"img:icons/Button_Payments.svg",size:"24px"}}),e("span",{staticClass:"btn-title"},[t._v("Оплатить")])],1)],1):t._e()],1)],1):t._e(),2==t.$route.params.step?e("div",{staticClass:"content-page school-record"},[e("q-card",{staticClass:"card-shadow fit font-sspro-sr"},[e("q-card-section",{staticClass:"q-pa-xs school-record-card-content row"},[e("iframe",{directives:[{name:"show",rawName:"v-show",value:!t.loadedWidget,expression:"!loadedWidget"}],staticClass:"fit",staticStyle:{border:"none"},attrs:{id:"iframe-pay",src:t.widget_uri,bordered:"0"}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.loadedWidget,expression:"loadedWidget"}],staticClass:"fit flex flex-center"},[e("div",{staticClass:"text-center"},[e("img",{attrs:{src:"https://www.cdn-tinkoff.ru/platform/modules/header/1.22.2/8e5ac93f884752e5b61104ccc1d62aca.svg",width:"150px"}}),e("br"),e("br"),t._v("\n    Загрузка платежного модуля...\n    ")])])]),e("q-card-section",{staticClass:"row items-center justify-start fit q-pl-lg",staticStyle:{"max-height":"100px"}},[e("q-btn",{staticClass:"btn-blue-grey",attrs:{flat:"","no-caps":"",to:"/payments/buy-courses/1"}},[e("q-icon",{staticStyle:{transform:"rotate(180deg)"},attrs:{name:"img:icons/Button_Navigation.svg",size:"20px"}}),e("span",{staticClass:"btn-title"},[t._v("Назад")])],1),e("q-space")],1)],1)],1):t._e()],1)},n=[],o=(e("4de4"),e("7db0"),e("caad"),e("c975"),e("e260"),e("d81d"),e("45fc"),e("d3b7"),e("e6cf"),e("ac1f"),e("2532"),e("3ca3"),e("1276"),e("ddb0"),e("ded3")),c=e.n(o),l=(e("bc3a"),e("2f62")),u=e("711b"),d=e("c1df"),p=e.n(d),m=(e("957c"),e("7212")),y=(e("a7a3"),e("9f3a")),g={name:"PaymentsBuyCourses",components:{Dropdown:u["a"],Swiper:m["Swiper"],SwiperSlide:m["SwiperSlide"],PageLoader:y["a"]},data:function(){return{pageIsLoad:!1,loadedWidget:!0,widget_uri:null,prepeareLoading:!1,showduration:!1,showType:!1,tariffText:["1 месяц","3 месяца","1 год"],currentStudyTypeValue:null,currentStudyTypeLabel:null,dialogChangeStudyType:!1,currentCourse:null,purchedCoursesLiters:null,dataPay:{course_id:null,duration:null,study_type:"f",promo:""},swiperOptionSchools:{slidesPerView:4,slidesPerGroup:4,slidesPerColumn:1,spaceBetween:0,direction:"horizontal",scrollbar:{el:".swiper-scrollbar",dragClass:"swiper-scrollbar-drag scroll-drag"},navigation:{nextEl:".right-arrow",prevEl:".left-arrow"},breakpoints:{1170:{slidesPerView:4,slidesPerGroup:4,slidesPerColumn:1},890:{slidesPerView:3,slidesPerGroup:3,slidesPerColumn:1},550:{slidesPerView:2,slidesPerGroup:2,slidesPerColumn:1}}}}},methods:c()(c()({},Object(l["b"])(["payCourseTinkoff","getCourses","getCoursesPurched"])),{},{applyDiscount:function(){this.$q.notify({icon:"warning",message:"Промокод не действительный!",timeout:3e3,color:"blue-grey-10",html:!0,position:"top"})},dateFormat:function(t){return p()(t).format("LL").split(" г.")[0]},prepearePay:function(){var t=this;this.currentStudyTypeValue!=this.dataPay.study_type&&this.currentCourse.categories.some((function(s){return t.purchedCoursesLiters.indexOf(s)>=0}))?this.dialogChangeStudyType=!0:(this.prepeareLoading=!0,this.payCourseTinkoff(this.dataPay).then((function(s){t.prepeareLoading=!1,400!=s.status?200==s.status&&(t.widget_uri=s.data.widget_uri,t.$router.push("/payments/buy-courses/2")):t.$q.notify({icon:"warning",message:s.data.errors[0].message,timeout:3e3,color:"blue-grey-10",html:!0,position:"top"})})).catch((function(s){t.prepeareLoading=!1})))}}),watch:{currentCourse:function(t){this.dataPay.course_id=t.id||null;var s=_.filter(this.coursesPurched,(function(s){return t.categories.includes(s.category)}));this.currentStudyTypeValue=s.length>0?s[0].study_type:this.dataPay.study_type,this.currentStudyTypeLabel=_.find(this.types,{value:this.currentStudyTypeValue}).label,this.purchedCoursesLiters=_.sortBy(_.map(this.coursesPurched,(function(t){return t.category})))},$route:function(t){var s=this;2==t.params.step&&(this.loadedWidget=!0,this.$nextTick((function(){var t=document.getElementById("iframe-pay");t.onload=function(){s.loadedWidget=!1}})))}},computed:c()(c()({},Object(l["c"])(["coursesList"])),{},{durations:function(){return this.currentCourse?[{label:'1 месяц за <b class="text-dark">'+this.numberWithSpaces(this.currentCourse["cost1"])+" руб.</b>",value:"1m",cost:"cost1"},{label:'3 месяца за <b class="text-dark">'+this.numberWithSpaces(this.currentCourse["cost2"])+" руб.</b>",value:"3m",cost:"cost2"},{label:'1 год за <b class="text-dark">'+this.numberWithSpaces(this.currentCourse["cost3"])+" руб.</b>",value:"yr",cost:"cost3"}]:null},types:function(){return[{label:"Открыть все уроки",value:"f"},{label:"Пошаговое обучение",value:"s"}]},summ:function(){return this.durations?this.currentCourse[_.find(this.durations,{value:this.dataPay.duration}).cost]:0}}),mounted:function(){var t=this;this.pageIsLoad=!0;var s=this.getCoursesPurched({}),e=this.getCourses({});Promise.all([s,e]).then((function(s){t.pageIsLoad=!1,t.$route.query.hasOwnProperty("category")?(t.currentCourse=_.filter(t.coursesList,(function(s){return 1==s.categories.length&&s.categories.includes(t.$route.query.category)}))[0],t.$nextTick((function(){t.$refs.swiperSchools.$swiper.slideTo(1,300)}))):t.currentCourse=t.coursesList[0],t.dataPay.duration=t.durations[0].value}))}},f=g,C=e("2877"),v=e("9989"),h=e("24e8"),b=e("f09f"),q=e("a370"),w=e("9c40"),x=e("2c91"),P=e("0016"),S=e("eb85"),k=e("1c1c"),L=e("66e5"),T=e("4074"),$=e("0170"),Q=e("27f9"),I=e("54e1"),W=e("eebe"),B=e.n(W),j=Object(C["a"])(f,i,n,!1,null,null,null),V=j.exports;B()(j,"components",{QPage:v["a"],QDialog:h["a"],QCard:b["a"],QCardSection:q["a"],QBtn:w["a"],QSpace:x["a"],QIcon:P["a"],QSeparator:S["a"],QList:k["a"],QItem:L["a"],QItemSection:T["a"],QItemLabel:$["a"],QInput:Q["a"],QBanner:I["a"]});var z=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("q-page",[e("q-dialog",{model:{value:t.dialogInfo,callback:function(s){t.dialogInfo=s},expression:"dialogInfo"}},[e("q-card",{staticClass:"dialog-gradient"},[e("q-card-section",{staticClass:"row items-center"},[e("div",{staticClass:"col-auto"},[e("span",{staticClass:"attention-item"},[t._v("!")])]),e("div",{staticClass:"col font-exo2-m fs-20"},[t._v("Режимы обучения")])]),e("q-card-section",[e("div",{staticClass:"fs-15 font-sspro-sr",staticStyle:{"line-height":"20px"}},[t._v("\n           При выборе режима "),e("b",[t._v("«Открыть все уроки»")]),t._v(" у Вас будет доступ ко всем урокам. Вы сможете просматривать их в любом порядке.\n           "),e("q-separator",{staticClass:"q-mt-md q-mb-md"}),t._v("\n           При выборе "),e("b",[t._v("«Пошаговое обучение»")]),t._v(' у Вас будет открыт только один урок. Чтобы получить доступ к следующему, вам будет необходимо просмотреть урок полностью от начала до конца, а также сдать зачет по пройденной теме (при просмотре урока в первый раз перемотка не будет работать)."\n          ')],1)]),e("q-card-section",{attrs:{align:"center"}},[e("q-btn",{staticClass:"btn-orange full-width",attrs:{"no-caps":""},on:{click:function(s){s.stopPropagation(),s.preventDefault(),t.dialogInfo=!1}}},[e("span",{staticClass:"btn-title"},[t._v("Понятно")])])],1)],1)],1),e("q-dialog",{model:{value:t.dialogChangeStudyType,callback:function(s){t.dialogChangeStudyType=s},expression:"dialogChangeStudyType"}},[t.currentCourse?e("q-card",[e("q-card-section",{staticClass:"dialog-header",attrs:{align:"center"}},[t._v("\n      Внимание!\n    ")]),e("q-card-section",{staticStyle:{"font-size":"15px","line-height":"1.2"},attrs:{align:"center"}},[t._v("\n      У Вас есть купленный курс "),e("br"),t._v("\n      по "+t._s(t.getNoun(1==t.currentCourse.categories.length?t.currentCourse.categories.length:t.purchedCoursesLiters.length,"категории","категориям","категориям"))+"\n      "),e("span",{staticClass:"text-uppercase text-bold"},[t._v(t._s(1==t.currentCourse.categories.length?t.currentCourse.categories.join(", "):t.purchedCoursesLiters.join(", ")))]),e("br"),1==t.currentCourse.categories.length?e("span",[t._v("в режиме "),e("b",[t._v('"'+t._s(t.currentStudyTypeLabel)+'"')])]):t._e(),e("br"),e("br"),t._v("\n      Вам необходимо выбрать режим"),e("br"),t._v("  \n      дальнейшей работы по  "+t._s(t.getNoun(t.currentCourse.categories.length,"категории","категориям","категориям"))+" "),e("span",{staticClass:"text-uppercase text-bold"},[t._v(t._s(t.currentCourse.categories.join(", ")))])]),e("q-card-section",{staticClass:"row items-center"},t._l(t.types,(function(s){return e("div",{staticClass:"col row items-center"},[e("q-btn",{staticClass:"btn-orange-mobile q-ma-xs",attrs:{"no-caps":"",flat:"",rounded:""},on:{click:function(e){t.dataPay.study_type=t.currentStudyTypeValue=s.value,t.prepearePay()}}},[e("span",{staticClass:"btn-title"},[t._v(t._s(s.label))])])],1)})),0)],1):t._e()],1),e("q-card",{staticClass:"lessons transparent",staticStyle:{"border-radius":"0 !important"},attrs:{flat:""}},[e("q-card-section",{staticClass:"lesson-top relative-position full-width"},[e("div",{staticClass:"row items-center"},[e("div",{staticClass:"col-auto"},[e("q-btn",{staticClass:"q-pr-md",attrs:{dense:"",round:"",flat:""},on:{click:function(s){return t.$router.go(-1)}}},[e("q-icon",{staticStyle:{transform:"rotate(180deg)"},attrs:{name:"img:icons/schedule.svg",size:"20px"}})],1)],1),1==t.$route.params.step?e("div",{staticClass:"col"},[e("div",{staticClass:"row items-center"},[e("div",{staticClass:"col"},[e("div",{staticClass:"lesson-head"},[t._v("Покупка онлайн-курса")])])]),e("div",{staticClass:"row q-mt-xs"},[e("div",{staticClass:"col text-left"},[e("div",{staticClass:"lesson-subtitle"},[t._v("Выберите курс")])])])]):t._e(),2==t.$route.params.step?e("div",{staticClass:"col"},[e("div",{staticClass:"row items-center"},[e("div",{staticClass:"col"},[e("div",{staticClass:"lesson-head"},[t._v(t._s(t.currentCourse.title))])])]),e("div",{staticClass:"row q-mt-xs"},[e("div",{staticClass:"col text-left"},[e("div",{staticClass:"lesson-subtitle"},[t._v("Оплата курса")])])])]):t._e()])])],1),1==t.$route.params.step?e("div",{staticClass:"row items-center q-pa-sm"},[t._l(t.coursesList,(function(s,a){return e("div",{staticClass:"col-6 q-pa-xs",on:{click:function(e){t.currentCourse=s}}},[e("q-card",{staticClass:"gradient-grey",class:{"border-card-active":t.currentCourse==s,"border-card-noactive":t.currentCourse!=s}},[e("q-card-section",{attrs:{align:"center"}},[e("div",{staticClass:"q-mt-md",staticStyle:{height:"35px",width:"80px","background-repeat":"no-repeat","background-position":"bottom center","background-size":"contain"},style:{"background-image":"url(icons/Payment_"+(1==s.categories.length?s.categories.join("").toUpperCase():"ABC")+"_"+(t.currentCourse==s?"R":"G")+".svg)"}})]),e("q-card-section",{staticClass:"fs-17 font-exo2-m q-pt-none",class:{"text-accent":t.currentCourse==s},attrs:{align:"center"}},[t._v("\n            "+t._s(s.title)+"\n          ")]),e("q-separator"),e("q-card-section",{staticClass:"q-pa-none"},[e("q-list",{attrs:{separator:"",dense:""}},t._l(3,(function(a){return e("q-item",{key:a},[e("q-item-section",[e("div",{staticClass:"row items-center"},[e("div",{staticClass:"col-4 font-sspro-sr ellipsis text-right fs-12"},[t._v(t._s(t.tariffText[a-1]))]),e("div",{staticClass:"col-8 font-sspro-sr q-pl-lg ellipsis fs-18"},[t._v(t._s(t.numberWithSpaces(s["cost"+a]))+" р.")])])])],1)})),1)],1)],1)],1)})),e("q-list",{staticClass:"q-pa-none full-width  form-settings",attrs:{separator:""}},[e("q-item",{staticClass:"q-pa-md"},[e("q-item-section",[e("q-item-label",{staticClass:"fs-12 text-secondary"},[t._v("\n              Выберите срок обучения\n            ")]),e("q-item-label",{staticClass:"fs-18"},[t._v("\n              "+t._s(t.getCurrentDurationLabel)+"\n            ")])],1),e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{round:"",flat:"",icon:"img:icons/od.svg",size:"12px"}},[e("q-menu",{attrs:{"content-class":"normal"}},[t.durations?e("q-card",[e("q-card-section",{staticClass:"q-pa-none"},[e("q-list",{staticClass:"q-pa-none",attrs:{separator:""}},t._l(t.durations,(function(s){return e("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:t.dataPay.value,attrs:{active:t.dataPay.duration==s.value,clickable:"","active-class":"bg-grey-3"},on:{click:function(e){t.dataPay.duration=s.value}}},[e("q-item-section",[e("q-item-label",[t._v("\n                            "+t._s(s.label)+"\n                          ")])],1)],1)})),1)],1)],1):t._e()],1)],1)],1)],1),e("q-item",{staticClass:"q-pa-md"},[e("q-item-section",[e("q-item-label",{staticClass:"fs-12 text-secondary"},[t._v("\n              Выберите режим обучения \n            ")]),e("q-item-label",{staticClass:"fs-18"},[t._v("\n              "+t._s(t.getCurrentStudyTypeLabel)+" "),e("q-btn",{attrs:{flat:"",size:"sm",round:"",icon:"img:icons/info.svg"},on:{click:function(s){t.dialogInfo=!0}}})],1)],1),e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{round:"",flat:"",icon:"img:icons/od.svg",size:"12px"}},[e("q-menu",{attrs:{"content-class":"normal"}},[t.types?e("q-card",[e("q-card-section",{staticClass:"q-pa-none"},[e("q-list",{staticClass:"q-pa-none",attrs:{separator:""}},t._l(t.types,(function(s){return e("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:t.dataPay.value,attrs:{active:t.dataPay.study_type==s.value,clickable:"","active-class":"bg-grey-3"},on:{click:function(e){t.dataPay.study_type=s.value}}},[e("q-item-section",[e("q-item-label",[t._v("\n                            "+t._s(s.label)+"\n                          ")])],1)],1)})),1)],1)],1):t._e()],1)],1)],1)],1),e("q-item",{staticClass:"q-pt-sm q-pb-none"},[e("q-item-section",[e("q-input",{staticClass:"full-width",attrs:{dense:"","input-class":"fs-15"},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{staticClass:"q-pr-sm",attrs:{name:"img:icons/edit_mobile.svg",size:"15px"}})]},proxy:!0},{key:"append",fn:function(){return[e("div",{staticClass:"row items-center"},[e("div",{staticClass:"fs-12 col"},[t._v("Промокод")]),t.dataPay.promo?e("q-btn",{staticClass:"col-auto",attrs:{"no-caps":"",flat:""},on:{click:function(s){return t.applyDiscount()}}},[e("q-icon",{attrs:{name:"img:icons/Apply_Promo.svg",size:"16px"}}),e("span",{staticClass:"q-ml-sm font-sspro-sr fs-15 text-accent"},[t._v("Применить")])],1):t._e()],1)]},proxy:!0}],null,!1,32002554),model:{value:t.dataPay.promo,callback:function(s){t.$set(t.dataPay,"promo",s)},expression:"dataPay.promo"}})],1)],1),e("q-item",{staticClass:"q-pt-sm q-pb-none"},[e("q-item-section",[e("div",{staticClass:"row items-center"},[e("div",{staticClass:"col text-center text-secondary font-exo2-m fs-20"},[t._v(t._s(t.numberWithSpaces(t.summ))+" "),e("span",{staticClass:"currency"},[t._v("Р")]),e("p",{staticClass:"text-secondary font-sspro-sr fs-15 q-mt-sm"},[t._v("Стоимость")])]),e("div",{staticClass:"col text-center text-secondary font-exo2-m fs-20"},[t._v("0 "),e("span",{staticClass:"currency"},[t._v("Р")]),e("p",{staticClass:"text-secondary font-sspro-sr fs-15 q-mt-sm"},[t._v("Скидка")])]),e("div",{staticClass:"col text-center text-dark font-exo2-m fs-20"},[t._v(t._s(t.numberWithSpaces(t.summ))+"  "),e("span",{staticClass:"currency"},[t._v("Р")]),e("p",{staticClass:"text-secondary font-sspro-sr fs-15 q-mt-sm"},[t._v("Итого:")])])])])],1),e("q-item",{staticClass:"q-pt-sm q-pb-none"},[e("q-item-section",[e("q-btn",{staticClass:"btn-orange-mobile",attrs:{"no-caps":"",flat:"",rounded:"",loading:t.prepeareLoading},on:{click:function(s){return t.prepearePay()}}},[e("q-icon",{attrs:{name:"img:icons/Button_Payments.svg",size:"24px"}}),e("span",{staticClass:"btn-title"},[t._v("Оплатить")])],1)],1)],1)],1)],2):t._e(),2==t.$route.params.step?e("div",{staticClass:"row items-center q-pa-sm bg-white",staticStyle:{height:"calc(100vh - 160px)"}},[e("q-card-section",{staticClass:"q-pa-none fit"},[e("iframe",{directives:[{name:"show",rawName:"v-show",value:!t.loadedWidget,expression:"!loadedWidget"}],staticClass:"fit",staticStyle:{border:"none"},attrs:{id:"iframe-pay",src:t.widget_uri,bordered:"0"}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.loadedWidget,expression:"loadedWidget"}],staticClass:"fit flex flex-center"},[e("div",{staticClass:"text-center"},[e("img",{attrs:{src:"https://www.cdn-tinkoff.ru/platform/modules/header/1.22.2/8e5ac93f884752e5b61104ccc1d62aca.svg",width:"150px"}}),e("br"),e("br"),t._v("\n                  Загрузка платежного модуля...\n                ")])])])],1):t._e()],1)},D=[],O=e("cf91"),N={name:"PaymentsBuyCourses",components:{Dropdown:u["a"],PayDialog:O["a"]},data:function(){return{loadedWidget:!0,widget_uri:null,prepeareLoading:!1,showduration:!1,showType:!1,currentStudyTypeValue:null,dialogChangeStudyType:!1,tariffText:["1 месяц","3 месяца","1 год"],purchedCoursesLiters:null,currentCourse:null,dialogInfo:!1,dataPay:{course_id:null,duration:null,study_type:"f",promo:""}}},methods:c()(c()({},Object(l["b"])(["payCourseTinkoff","getCourses"])),{},{applyDiscount:function(){this.$q.notify({icon:"warning",message:"Промокод не действительный!",timeout:3e3,color:"blue-grey-10",html:!0,position:"top"})},dateFormat:function(t){return p()(t).format("LL").split(" г.")[0]},prepearePay:function(){var t=this;this.currentStudyTypeValue!=this.dataPay.study_type&&this.currentCourse.categories.some((function(s){return t.purchedCoursesLiters.indexOf(s)>=0}))?this.dialogChangeStudyType=!0:(this.prepeareLoading=!0,this.payCourseTinkoff(this.dataPay).then((function(s){t.prepeareLoading=!1,400!=s.status?200==s.status&&(t.widget_uri=s.data.widget_uri,t.$router.push("/payments/buy-courses/2")):t.$q.notify({icon:"warning",message:s.data.errors[0].message,timeout:3e3,color:"blue-grey-10",html:!0,position:"top"})})).catch((function(s){t.prepeareLoading=!1})))}}),watch:{currentCourse:function(t){this.dataPay.course_id=t.id||null;var s=_.filter(this.coursesPurched,(function(s){return t.categories.includes(s.category)}));this.currentStudyTypeValue=s.length>0?s[0].study_type:this.dataPay.study_type,this.currentStudyTypeLabel=_.find(this.types,{value:this.currentStudyTypeValue}).label,this.purchedCoursesLiters=_.sortBy(_.map(this.coursesPurched,(function(t){return t.category})))},$route:function(t){var s=this;2==t.params.step&&(this.loadedWidget=!0,this.$nextTick((function(){var t=document.getElementById("iframe-pay");t.onload=function(){s.loadedWidget=!1}})))}},computed:c()(c()({},Object(l["c"])(["coursesList"])),{},{durations:function(){return this.currentCourse?[{label:"1 месяц за "+this.currentCourse["cost1"]+" руб.",value:"1m",cost:"cost1"},{label:"3 месяца за "+this.currentCourse["cost2"]+" руб.",value:"3m",cost:"cost2"},{label:"1 год за "+this.currentCourse["cost3"]+" руб.",value:"yr",cost:"cost3"}]:null},types:function(){return[{label:"Открыть все уроки",value:"f"},{label:"Пошаговое обучение",value:"s"}]},summ:function(){return this.durations?this.currentCourse[_.find(this.durations,{value:this.dataPay.duration}).cost]:0},getCurrentDurationLabel:function(){return this.durations?_.find(this.durations,{value:this.dataPay.duration}).label:""},getCurrentStudyTypeLabel:function(){return this.types?_.find(this.types,{value:this.dataPay.study_type}).label:""}}),mounted:function(){var t=this,s=this.getCoursesPurched({}),e=this.getCourses({});this.pageIsLoad=!1,Promise.all([s,e]).then((function(s){t.$route.query.hasOwnProperty("category")?t.currentCourse=_.filter(t.coursesList,(function(s){return 1==s.categories.length&&s.categories.includes(t.$route.query.category)}))[0]:t.currentCourse=t.coursesList[0],t.dataPay.duration=t.durations[0].value,t.currentStudyTypeValue=t.coursesPurched.length>0?t.coursesPurched[0].study_type:t.dataPay.study_type,t.currentStudyTypeLabel=_.find(t.types,{value:t.currentStudyTypeValue}).label,t.purchedCoursesLiters=_.sortBy(_.map(t.coursesPurched,(function(t){return t.category})))}))}},E=N,A=e("4e73"),G=e("7f67"),R=Object(C["a"])(E,z,D,!1,null,null,null),F=R.exports;B()(R,"components",{QPage:v["a"],QDialog:h["a"],QCard:b["a"],QCardSection:q["a"],QSeparator:S["a"],QBtn:w["a"],QIcon:P["a"],QList:k["a"],QItem:L["a"],QItemSection:T["a"],QItemLabel:$["a"],QMenu:A["a"],QInput:Q["a"]}),B()(R,"directives",{ClosePopup:G["a"]});var J={name:"PaymentsBuyCourses",components:{PaymentsBuyCoursesDesktop:V,PaymentsBuyCoursesMobile:F}},M=J,U=Object(C["a"])(M,a,r,!1,null,null,null);s["default"]=U.exports;B()(U,"components",{QPage:v["a"]})}}]);