(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{a9c3:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-icon",{staticStyle:{display:"none"},attrs:{name:"signal_wifi_off",size:"0px"}}),s("vue-online-offline",{on:{online:t.isOnline,offline:t.isOffline}}),s("q-dialog",{model:{value:t.dialogInternetConnetion,callback:function(e){t.dialogInternetConnetion=e},expression:"dialogInternetConnetion"}},[s("q-card",[s("q-card-section",{attrs:{align:"center"}},[s("q-icon",{attrs:{size:"36px",name:"signal_wifi_off"}}),s("br"),t._v("\n        Проверьте подключение к интернету!\n      ")],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.dialogCities,callback:function(e){t.dialogCities=e},expression:"dialogCities"}},[s("q-card",{staticClass:"q-pa-xs",staticStyle:{width:"250px"}},[s("q-item-section",{staticClass:"q-pa-md",attrs:{align:"center"}},[s("q-item-label",{staticClass:"text-h6"},[t._v("\n          Выберите город\n        ")])],1),t.filterCities?s("q-card-section",{staticClass:"q-pa-none"},[t.currCity?s("q-item",{staticClass:"bg-white text-left",attrs:{clickable:""}},[s("q-item-section",{staticStyle:{"min-width":"35px"},attrs:{avatar:""}},[s("q-icon",{attrs:{name:"img:icons/Address.svg"}})],1),s("q-item-section",[s("q-item-label",{staticStyle:{size:"14px","font-weight":"bold"}},[t._v("\n              "+t._s(t.currCity.title)+"\n            ")]),s("q-item-label",{attrs:{caption:""}},[t._v("\n              "+t._s(t.currCity.region)+"\n            ")])],1),s("q-menu",{attrs:{"content-class":"normal",fit:"",anchor:"top left",self:"top left"}},[s("div",[s("q-input",{attrs:{dense:"",placeholder:"Поиск"},scopedSlots:t._u([{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!1,2901929698),model:{value:t.searchCity,callback:function(e){t.searchCity=e},expression:"searchCity"}})],1),s("q-list",{staticClass:"q-pa-none",attrs:{separator:""}},[0==t.filterCities.length?s("q-item",[s("q-item-section",[s("q-item-label",{staticStyle:{size:"14px","font-weight":"bold"}},[t._v("\n                    Ничего не найдено!\n                  ")]),s("q-item-label",{attrs:{caption:""}},[t._v("\n                    Попробуйте изменить запрос...\n                  ")])],1)],1):t._e(),t._l(t.filterCities,(function(e){return s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:e.id,staticClass:"bg-white",attrs:{clickable:""},on:{click:function(s){t.currCity=e}}},[s("q-item-section",[s("q-item-label",{staticStyle:{size:"14px","font-weight":"bold"}},[t._v("\n                    "+t._s(e.title)+"\n                  ")]),s("q-item-label",{attrs:{caption:""}},[t._v("\n                    "+t._s(e.region)+"\n                  ")])],1)],1)}))],2)],1)],1):t._e()],1):t._e(),s("q-card-section",{attrs:{align:"center"}},[s("q-btn",{staticClass:"btn-orange-mobile col-auto",attrs:{flat:"","no-caps":"",label:"Да, это мой город",loading:t.loadingCity},on:{click:function(e){return t.updateCity()}}})],1),s("q-item-section",{staticClass:"q-pa-md",attrs:{align:"center"}},[s("q-item-label",[t._v("\n          Не нашли город, нажмите "),s("u",{staticClass:"text-accent cursor-pointer",on:{click:function(e){return t.noUserCity()}}},[t._v("здесь")])])],1)],1)],1),s("div",{staticClass:"backdrop-nav",class:{active:t.backdropNav}}),t.backdrop?s("div",{staticClass:"backdrop"}):t._e(),t.api_path?s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[t.notAuthRoutes.includes(t.$route.name)||t.$q.screen.lt.sm?t._e():s("header-desktop",{ref:"header"}),t.notAuthRoutes.includes(t.$route.name)||t.$q.platform.is.mobile?t._e():s("menu-desktop"),s("q-page-container",[t.notAuthRoutes.includes(t.$route.name)||!t.notAuthRoutes.includes(t.$route.name)&&t.userInfo?s("router-view",{ref:"page",on:{loadPage:t.loadPage,verifyTokenInit:t.verifyTokenInit,initFirstData:t.initFirstData}}):t._e()],1),!t.notAuthRoutes.includes(t.$route.name)&&!t.testsRoutes.includes(t.$route.name)&&t.$q.platform.is.mobile&&t.showNavMobile?s("q-footer",[s("mobile-nav")],1):t._e(),t.isMounted?t._e():s("div",{staticClass:"absolute-top-left row items-center justify-center bg-dark",staticStyle:{"z-index":"10000",width:"100vw",height:"100vh"}},[s("q-spinner-tail",{staticClass:"text-accent",attrs:{size:"50px"}})],1)],1):t._e()],1)},n=[],a=(s("4de4"),s("caad"),s("c975"),s("e260"),s("b0c0"),s("d3b7"),s("e6cf"),s("2532"),s("3ca3"),s("ddb0"),s("ded3")),o=s.n(a),r=s("bc3a"),c=s.n(r),l=s("c1df"),u=s.n(l),d=s("ec02"),h=s.n(d),g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-dialog",{attrs:{maximized:!0,position:"right"},on:{show:t.resizePage,"before-show":t.openChatPanel,"before-hide":t.closeChatPanel},model:{value:t.dialogChat,callback:function(e){t.dialogChat=e},expression:"dialogChat"}},[s("q-card",{staticClass:"fit q-pa-none q-ma-none",staticStyle:{"min-width":"480px"}},[s("q-card-section",{staticClass:"q-pa-none fit"},[s("div",{staticClass:"messages"},[s("div",{staticClass:"messages-folder",staticStyle:{"max-width":"480px"}},[s("div",{staticClass:"messages-topSide"},[s("div",{staticClass:"messages-caption"},[s("div",{staticClass:"title"},[s("img",{attrs:{src:"icons/TopBar_Messages.svg",alt:""}}),s("p",{staticClass:"text"},[t._v("Сообщения")]),t.all_unreaded_message_count>0?s("div",{staticClass:"amount"},[t._v(t._s(t.all_unreaded_message_count))]):t._e()]),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"img:icons/Cancel_G.svg",size:"10px",round:"",flat:""}})],1),s("div",{staticClass:"messages-types"},t._l(t.listContacts,(function(e){return s("div",{staticClass:"messages-types-item",class:{active:t.currContactID==e.id},on:{click:function(s){t.currContactID=e.id}}},[s("p",{staticClass:"messages-types-item-text"},[t._v(t._s(e.full_name))]),e.unreaded_message_count>0?s("div",{staticClass:"amount"},[t._v("\n                    "+t._s(e.unreaded_message_count)+"\n                    ")]):t._e()])})),0),s("div",{staticClass:"user"},[s("div",{staticClass:"user-avatar"},[s("img",{attrs:{src:t.currContact&&t.currContact.avatar?t.origin+"/"+t.currContact.avatar:t.avatar_null,alt:""}})]),s("div",{staticClass:"user-username"},[t._v("\n                      "+t._s(t.currContact&&t.currContact.full_name?t.currContact.full_name:"-")+"\n                    ")]),s("div",{staticClass:"user-status"},[s("span",{staticClass:"online"},[s("span",{staticClass:"bg"})]),s("p",{staticClass:"text"},[t._v("На связи")])])])]),s("div",[s("chat",{ref:"chat_group",attrs:{height:t.chatHeight}})],1)])])])],1)],1),t.userInfo?s("q-header",{staticClass:"row items-center bg-grad-header q-ma-none q-pa-none",staticStyle:{height:"64px",color:"#7b7c90"}},[t.miniState&&t.$q.screen.width>890?s("div",{staticClass:"col-auto row items-center q-pl-md q-pr-md justify-center"},[s("img",{attrs:{src:"img/Panel_Logo_0.png",width:"32"}})]):t._e(),t.miniState?s("q-separator",{attrs:{vertical:""}}):t._e(),s("div",{staticClass:"col-auto q-ml-md"},[s("div",{staticClass:"user-avatar small"},[s("img",{attrs:{src:t.userInfo.avatar?t.origin+"/"+t.userInfo.avatar:t.avatar_null,height:"100%"}})])]),t.$q.screen.width>890?s("div",{staticClass:"col-auto q-ml-sm text-uppercase font-sspro-sb",staticStyle:{"font-size":"15px"}},[s("span",{staticClass:"text-primary"},[t._v(t._s(t.userInfo.first_name))])]):t._e(),s("div",{staticClass:"col-auto q-ml-lg",staticStyle:{"font-size":"16px"}},[t._v("\n        Мой ID: "+t._s(t.userInfo.id)+"\n      ")]),t.userInfo&&t.userInfo.group.number?s("div",{staticClass:"col-auto q-ml-lg",staticStyle:{"font-size":"16px"}},[t._v("\n         Моя группа: "+t._s(t.userInfo.group.number)+"\n        ")]):t._e(),t.$q.screen.width>890?s("div",{staticClass:"col-auto q-ml-lg",staticStyle:{"font-size":"15px"}},[t._v("\n        Категория:\n      ")]):t._e(),s("div",{staticClass:"col-auto q-ml-sm text-subtitle2"},t._l(t.categoriesAll,(function(e){return t.currCat==e&&!t.hideCategoryRoutes||t.hideCategoryRoutes?s("q-btn",{key:e,staticClass:"q-ml-xs q-mr-xs bg-btn-category",class:{"bg-primary text-white":e==t.currCat},attrs:{dense:"",flat:"",round:"",loading:e==t.loadingCat&&t.stateLoaderCategory,size:"13px"},on:{click:function(s){return t.setCategory(e)}}},[s("span",{staticClass:"text-subtitle1"},[t._v(t._s(e))])]):t._e()})),1),s("q-space"),t.notShowRoutMailings.includes(t.$route.name)?t._e():s("div",{staticClass:"col-auto q-ml-sm q-mr-lg text-subtitle2 cursor-pointer",on:{click:function(e){0==t.countNewMailings&&t.$router.push("/mailings")}}},[s("q-icon",{attrs:{name:"img:icons/TopBar_Notifications_G.svg",size:"16px"}}),t.$q.screen.width>1e3?s("span",{staticClass:"q-ml-sm"},[t._v("\n          "+t._s(0==t.countNewMailings?"Уведомлений нет":"Уведомления")+"\n          ")]):t._e(),t.countNewMailings>0?s("div",{staticClass:"round-amount inline-block q-ml-sm q-mr-md"},[s("span",[t._v(t._s(t.countNewMailings))])]):t._e(),s("q-menu",{attrs:{"content-class":"normal",anchor:"bottom right",self:"top right",offset:[0,10]},on:{show:t.showMailings}},[t.listMailingsNotReaded?s("q-list",{staticStyle:{width:"300px"},attrs:{separator:""}},[t._l(t.listMailingsNotReaded,(function(e){return s("q-item",{key:e.id,staticClass:"item-mailing",attrs:{clickable:"",to:"/mailings/"+e.id}},[s("q-item-section",{staticClass:"row justify-center"},[s("q-item-label",[e.readed?t._e():s("span",{staticClass:"new"}),t._v(" "+t._s(e.title)+"\n        ")])],1)],1)})),s("q-item",{staticClass:"item-mailing",attrs:{clickable:"",to:"/mailings"}},[s("q-item-section",{staticClass:"row justify-center "},[s("q-item-label",{staticClass:"text-accent"},[s("q-icon",{attrs:{name:"add",size:"16px"}}),t._v(" Показать все\n        ")],1)],1)],1)],2):t._e()],1)],1),"lesson"!=t.$route.name?s("div",{staticClass:"col-auto q-ml-sm q-mr-sm text-subtitle2 cursor-pointer"},[s("div",{on:{click:function(e){t.dialogChat=!0}}},[s("q-icon",{attrs:{name:"img:icons/TopBar_Messages.svg",size:"16px"}}),t.$q.screen.width>1e3?s("span",{staticClass:"q-ml-sm"},[t._v("Сообщения")]):t._e(),t.all_unreaded_message_count>0?s("div",{staticClass:"round-amount inline-block q-ml-sm q-mr-md"},[s("span",[t._v(t._s(t.all_unreaded_message_count))])]):t._e()],1)]):t._e(),s("q-separator",{attrs:{vertical:""}}),s("div",{staticClass:"col-auto row items-center q-pl-md q-pr-md justify-center",staticStyle:{width:"64px"}},[s("q-btn",{attrs:{to:"/logout",round:"",flat:""}},[s("img",{attrs:{src:"icons/TopBar_Exit.svg",width:"18"}})])],1)],1):t._e(),s("q-resize-observer",{on:{resize:t.resizePage}})],1)},m=[],p=s("2f62"),f=s("e6b0"),v={name:"HaderDesktop",components:{Chat:f["a"]},data:function(){return{notShowRoutMailings:["lesson","mailings_id","mailings"],loadingCat:null,dialogChat:!1,chatHeight:0}},methods:o()(o()({},Object(p["b"])(["getContacts"])),{},{setCategory:function(t){this.loadingCat=t,this.getClientByCategory(t,!0)},showMailings:function(){this.getListMailings({readed:!1})},resizePage:function(){this.chatHeight=window.innerHeight-(void 0!=this.$refs.chat_group?this.$refs.chat_group.$el.getBoundingClientRect().top:0)},openChatPanel:function(){this.currContactID=this.lastContactID?this.lastContactID:this.listContacts[0].id,this.socketApp.send(JSON.stringify({command:"interlocutor",content:this.currContactID}))},closeChatPanel:function(){this.socketApp.send(JSON.stringify({command:"interlocutor",content:null}))}}),watch:{dialogChat:function(t){this.$store.dispatch("setChatIsOpen",t)},storeChatIsOpen:function(t){this.dialogChat=t}},computed:o()(o()({},Object(p["c"])(["origin","stateLoaderCategory","miniState","userCategories","userInfo","currCat","token"])),{},{storeChatIsOpen:function(){this.dialogChat=this.$store.getters.isChatOpen},listMailingsNotReaded:function(){return _.chunk(this.listMailings.results,5)[0]},hideCategoryRoutes:function(){for(var t=["results_datail_training","results_datail_credit","results_datail_exam","tickets_test","results_tickets_test","results_datail_tickets_test","results_training","results_credit","results_exam","lesson","group_credit","training","credit","exam"],e=0,s=t;e<s.length;e++){var i=s[e];if(this.$route.name==i)return!1}return!0}}),mounted:function(){}},C=v,y=(s("f7dd"),s("2877")),b=s("24e8"),q=s("f09f"),k=s("a370"),w=s("9c40"),S=s("e359"),I=s("eb85"),x=s("2c91"),$=s("0016"),A=s("4e73"),M=s("1c1c"),L=s("66e5"),N=s("4074"),O=s("0170"),P=s("3980"),Q=s("7f67"),z=s("eebe"),B=s.n(z),D=Object(y["a"])(C,g,m,!1,null,null,null),T=D.exports;B()(D,"components",{QDialog:b["a"],QCard:q["a"],QCardSection:k["a"],QBtn:w["a"],QHeader:S["a"],QSeparator:I["a"],QSpace:x["a"],QIcon:$["a"],QMenu:A["a"],QList:M["a"],QItem:L["a"],QItemSection:N["a"],QItemLabel:O["a"],QResizeObserver:P["a"]}),B()(D,"directives",{ClosePopup:Q["a"]});var R=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-drawer",{attrs:{mini:t.miniState,"mini-to-overlay":t.overlay,"show-if-above":"","content-class":"bg-drawer",width:240,"mini-width":64,breakpoint:600},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[s("q-list",{staticClass:"q-pa-none"},[s("q-item",{staticClass:"q-pa-none select-none",staticStyle:{"min-width":"64px",height:"64px"}},[s("q-item-section",{staticClass:"row items-center justify-center q-pr-none",staticStyle:{"min-width":"64px"},attrs:{avatar:""}},[t.overlay?t._e():s("img",{attrs:{src:"img/Panel_Logo_0.png",width:"32"}}),t.overlay?s("q-icon",{attrs:{name:t.miniState?"img:icons/Panel_Hamburger.svg":"img:icons/Arrow_UnHamburger.svg",size:"24px"},on:{click:function(e){t.miniState=!t.miniState}}}):t._e()],1),t.overlay?t._e():s("q-item-section",[s("img",{attrs:{src:"img/Panel_Logo_1.png",width:"110"}})])],1),t._l(t.menuDesktop,(function(e,i){return s("q-item",{key:i,staticClass:"item-menu q-pa-none select-none",class:t.isActiveItem(e),staticStyle:{"min-width":"64px",height:"64px"},attrs:{exact:"/"==e.url,to:e.url}},[s("q-item-section",{staticClass:"row items-center justify-center q-pr-none",staticStyle:{"min-width":"64px"},attrs:{avatar:""}},[s("q-icon",{attrs:{name:e.icon,size:"24px"}})],1),s("q-item-section",[s("q-item-label",[t._v("\n              "+t._s(e.title)+"\n            ")])],1),t.miniState?s("q-tooltip",{attrs:{"content-class":"bg-drawer font-vox-sbi text-subtitle1","content-style":"font-size: 16px",anchor:"center right",self:"center left"}},[t._v("\n            "+t._s(e.title)+"\n          ")]):t._e()],1)}))],2)],1)],1)},j=[],U={name:"MenuDesktop",data:function(){return{drawer:!1,forceOverlay:!1,menuDesktop:[{title:"Рабочий стол",icon:"img:icons/Panel_Menu_01.svg",url:"/dashboard",arrurls:["/lessons","/training"]},{title:"Расписание",icon:"img:icons/Panel_Menu_02.svg",url:"/schedule"},{title:"Билеты",icon:"img:icons/Panel_Menu_03.svg",url:"/tickets",arrurls:["/tickets"]},{title:"Статистика",icon:"img:icons/Panel_Menu_04.svg",url:"/statistic"},{title:"Оплаты",icon:"img:icons/Panel_Menu_05.svg",url:"/payments"},{title:"Базы знаний",icon:"img:icons/Panel_Menu_06.svg",url:"/guidebook",arrurls:["/guidebook"]},{title:"Настройки",icon:"img:icons/Panel_Menu_07.svg",url:"/settings"}]}},methods:{isActiveItem:function(t){if(t.url===this.$route.path||this.subIsActive(t.arrurls))return"q-router-link--exact-active q-router-link--active"}},computed:{miniState:{get:function(){return this.$store.state.glob.miniState},set:function(t){this.$store.commit("setMiniState",t)}},overlay:function(){return this.$q.screen.width<1500?this.miniState=!0:this.miniState=!1,this.$q.screen.width<1500}}},F=U,H=s("9404"),E=s("05c0"),J=Object(y["a"])(F,R,j,!1,null,null,null),W=J.exports;B()(J,"components",{QDrawer:H["a"],QList:M["a"],QItem:L["a"],QItemSection:N["a"],QIcon:$["a"],QItemLabel:O["a"],QTooltip:E["a"]});var G=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mobile-navigation"},[s("div",{staticClass:"nav-wrapper",class:t.isOpenNav?"":"closed"},[s("div",{staticClass:"items"},t._l(t.navigation,(function(e){return s("div",{key:e.title,staticClass:"item",class:t.isActiveItem(e),on:{click:function(s){return t.routeTo(e)}}},[s("div",{staticClass:"icon"},[s("img",{attrs:{src:"icons/mobile-icons/icon-"+e.img+("active"===t.isActiveItem(e)?"-active":"")+".svg"}})]),s("div",{staticClass:"item-title"},[t._v(t._s(e.title))])])})),0),s("div",{staticClass:"btn-toggler",on:{click:t.toggleNavigation}},[s("span",{staticClass:"btn-toggler-item-1",class:{active:t.hiddenItemMenu}}),s("span",{staticClass:"btn-toggler-item-2",class:{active:t.hiddenItemMenu}})])])])},V=[],K={name:"mobile-navigation",data:function(){return{hiddenItemMenu:!1,isOpenNav:!1,navigation:[{title:"Главная",url:"/dashboard",img:"1",hidden:!1},{title:"Уроки",url:"/lessons",img:"2",hidden:!1,arrurls:["/lessons","/training"]},{title:"Расписание",url:"/schedule",img:"3",hidden:!0},{title:"Теория",url:"/guidebook",img:"4",hidden:!1,arrurls:["/guidebook"]},{title:"Билеты",url:"/tickets",img:"5",hidden:!1,arrurls:["/tickets"]},{title:"Уведомления",url:"/mailings",img:"6",hidden:!0},{title:"Оплаты",url:"/payments",img:"7",hidden:!0},{title:"Настройки",url:"/settings",img:"8",hidden:!0},{title:"Статистика",url:"/statistic",img:"9",hidden:!0},{title:"Сообщения",url:"/messages",img:"10",hidden:!0}]}},watch:{isOpenNav:function(t){this.backdropNav=t}},methods:{toggleNavigation:function(){this.isOpenNav=!this.isOpenNav},routeTo:function(t){this.hiddenItemMenu=t.hidden,t.url!==this.$route.path&&(this.$router.push(t.url),this.isOpenNav=!1)},isActiveItem:function(t){if(t.url===this.$route.path||this.subIsActive(t.arrurls))return"active"}},computed:{zIndexNav:function(){return this.isOpenNav?"10":"9"}}},X=K,Y=Object(y["a"])(X,G,V,!1,null,null,null),Z=Y.exports,tt=(s("0967"),s("ea74")),et=s.n(tt),st=(s("7db0"),s("a15b"),s("d81d"),s("45fc"),s("ac1f"),s("25f0"),s("5319"),s("1276"),s("6374")),it=s.n(st),nt=(s("96cf"),s("c973")),at=s.n(nt),ot=(s("957c"),s("18d6"),s("f248")),rt=s("d04d"),ct={data:function(){return{lastContactID:null,avatar_null:"img/empty-avatar.png",scheduleList:[{type:"psihology",label:"Психология",datetime:null},{type:"medicine",label:"Медицина",datetime:null},{type:"driving",label:"Вождение",datetime:null},{type:"driving_exam",label:"Внутренний экзамен (практика)",datetime:null},{type:"internal_exam",label:"Внутренний экзамен (теория)",datetime:null},{type:"gibdd_exam",label:"Экзамен ГИБДД",datetime:null}]}},methods:o()(o()({},Object(p["b"])(["paySchoolTinkoff","generateContract","getTariffs","getCities","getSchools","getSales","setSocketApp","getChatMessages","setListContacts","setChatMessages","getContacts","getCoursesPurched","setApipath","setOrigin","setApiPrfix","setStateLoaderCategory","setUserCategorySelected","getStatisticsExam","getStatistics","getListMailings","getUserCategories","getListLessons","getNextStage","getTickets","refreshToken","verifyToken","getUserInfo","setUserInfo","setCurrCat","setIsAuth","setToken"])),{},{getClientByCategory:function(){var t=arguments,e=this;return at()(regeneratorRuntime.mark((function s(){var i,n,a,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=t.length>0&&void 0!==t[0]?t[0]:"a",t.length>1&&void 0!==t[1]&&t[1],e.setStateLoaderCategory(!0),e.setCurrCat(i),n=e.getUserInfo({category:i}),a=e.getNextStage({}),o=e.getListLessons({}),s.next=9,Promise.all([n,a,o]).then((function(t){e.setStateLoaderCategory(!1),e.setUserCategorySelected({selected_category:i}),e.setUserInfo(t[0].data)}));case 9:return s.next=11,!0;case 11:return s.abrupt("return",s.sent);case 12:case"end":return s.stop()}}),s)})))()},subIsActive:function(t){var e=this,s=Array.isArray(t)?t:[t];if("/"!=s[0])return s.some((function(t){return 0===e.$route.path.indexOf(t)}))},numberWithSpaces:function(t){var e=parseFloat(t).toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),e.join(".")},moment:function(t){return u()(t)},getNoun:function(t,e,s,i){var n=Math.abs(t);return n%=100,n>=5&&n<=20?i:(n%=10,1===n?e:n>=2&&n<=4?s:i)},dCopy:function(t){return JSON.parse(JSON.stringify(t))},dateIsAfter:function(t){return u()().isAfter(u()(t))},fancyTimeFormat:function(t){var e=~~(t/3600),s=~~(t%3600/60),i=~~t%60,n="";return e>0&&(n+=e+":"+(s<10?"0":"")),n+=s+":"+(i<10?"0":""),n+=""+i,n},formatFileSize:function(t){return ot(t)},lessonById:function(t){var e=_.find(this.listLessons,{id:parseInt(t)});return void 0==e?"":e},connectWebSocket:function(){var t=this;if(!this.socketApp){var e=new rt("wss://<production_host>/api/chat/",null,{debug:!0,reconnectInterval:3e3});this.setSocketApp(e),this.socketApp.addEventListener("open",(function(){t.socketApp.send(JSON.stringify({command:"token",content:t.token}))})),this.socketApp.addEventListener("message",(function(e){var s=JSON.parse(e.data);if("unreaded_count"===s.type){var i=t.dCopy(t.listContacts);t.$set(_.find(i,{id:s.content.sender_user_id}),"unreaded_message_count",s.content.count),t.setListContacts(i)}"message"===s.type&&("ticket_close"==s.content.kind&&t.currContact&&t.$set(t.currContact,"has_unmarked_ticket",!0),t.appendMessageSend(s.content)),"notification"===s.type&&(t.countNewMailings=s.content.unreaded_count)})),this.socketApp.addEventListener("error",(function(e){t.socketApp.close()}))}},appendMessageSend:function(t){var e=this.dCopy(this.chatMessages);e.push(t),this.setChatMessages(e)},getByThemes:function(t){for(var e="",s=t.lessonsList,i=0;i<s.length;i++){var n=s[i],a=i<s.length-1?", ":"";e+="#"+n+a}return e},turnOffAutoComplete:function(){this.$nextTick((function(){var t,e=document.querySelectorAll("input"),s=it()(e);try{for(s.s();!(t=s.n()).done;){var i=t.value;i.setAttribute("autocomplete","off")}}catch(n){s.e(n)}finally{s.f()}}))}}),computed:o()(o()({},Object(p["c"])(["maskphone","isTesting","origin","token","userInfo","currCat","chatMessages","listContacts","listMailings","listLessons","socketApp","userCategories","coursesPurched","nextStage","schoolsList","tariffsList"])),{},{currContact:function(){var t=_.find(this.listContacts,{id:this.currContactID});return void 0!=t?t:null},teacherContact:function(){var t=_.find(this.listContacts,{type:"tc"});return void 0!=t?t:null},all_unreaded_message_count:function(){var t=0;return _.map(this.listContacts,(function(e){t+=e.unreaded_message_count})),t},countNewMailings:{get:function(){return this.$store.state.mailings.countNewMailings},set:function(t){this.$store.commit("setCountNewMailings",t)}},dataRecord:{get:function(){return this.$store.state.payments.dataRecord},set:function(t){this.$store.commit("setDataRecord",t)}},currContactID:{get:function(){return this.$store.state.auth.currContactID},set:function(t){this.$store.commit("setCurrContactID",t)}},userSchool:{get:function(){return this.$store.state.payments.userSchool},set:function(t){this.$store.commit("setUserSchool",t)}},userHasSchool:function(){return!(!this.userSchool||!this.userSchool.hasOwnProperty("id"))},backdrop:{get:function(){return this.$store.state.glob.backdrop},set:function(t){this.$store.commit("setBackdrop",t)}},backdropNav:{get:function(){return this.$store.state.glob.backdropNav},set:function(t){this.$store.commit("setBackdropNav",t)}},categoriesAll:function(){return["a","b","c"]},nextStep:function(){if(this.userInfo){var t=this.nextStage.stage,e=this.nextStage.context,s=null,i="Сдать экзамен",n="/tickets/exam",a="img:icons/Check_W.svg",o="Свободный режим",r="";if("lesson_view"==t&&(s=e.lesson_id,n="/lessons/"+e.lesson_id,a="img:icons/Button_Watch.svg",i="Смотреть",o="Просмотреть урок #"+this.lessonById(e.lesson_id).number,r=this.lessonById(e.lesson_id).title),"lesson_credit"==t&&(s=e.lesson_id,n="/credit/"+e.lesson_id,a="img:icons/Button_Navigation.svg",i="Сдать зачет",o="Сдать зачет по уроку",r=this.lessonById(e.lesson_id).title),"lesson_training"==t&&(s=e.lesson_id,n="/training/"+e.lesson_id,a="img:icons/Button_Training.svg",i="Тренировка",o="Пройти тренировку по уроку",r=this.lessonById(e.lesson_id).title),"group_credit"==t){var c="";if(""!=this.lessonById(0))for(var l=this.lessonById(0).lessonsList,u=0;u<l.length;u++){var d=l[u],h=u<l.length-1?", ":"";c+="#"+d+h}s=null,n="/group_credit",a="img:icons/Button_Navigation.svg",i="Групповой зачет",o="Сдать групповой зачет",r="Уроки "+c}return"free"==t&&(s=null,n=this.$q.platform.is.mobile?"/lessons":"/dashboard",a="img:icons/Check_W.svg",i=this.$q.platform.is.mobile?"К списку уроков":"Рабочий стол",o="Свободное обучение",r="Вы можете выбрать любой урок"),"blocked"==t&&(s=null,n="/payments",a="img:icons/Check_W.svg",i="Перейти",(e.reason="payment_required")&&(o="У вас закончились демо уроки.",r='Если вы хотите записаться в автошколу или приобрести курс видеоуроков, переходите в раздел "Оплаты"')),{id:s,url:n,label:i,icon:a,title:o,subtitle:r,stage:t,context:e}}return null}})},lt=s("2b0e"),ut=s("59ca");s("ea7b"),lt["default"].mixin(ct),lt["default"].prototype.$moment=u.a;var dt={name:"Layout",components:{VueOnlineOffline:et.a,HeaderDesktop:T,MenuDesktop:W,MobileNav:Z},data:function(){return{searchCity:"",loadingCity:!1,currCity:null,dialogCities:!1,dialogInternetConnetion:!1,isLoadPage:!1,isMounted:!1,testsRoutes:["training","credit","group_credit","exam","tickets_test"],notAuthRoutes:["auth","vk-auth","restore","passwordnew","registration"]}},computed:o()(o()({},Object(p["c"])(["citiesList","showNavMobile","currContactID","userCategories","firebaseApp","api_prefix","api_path","userInfo","currCat","origin","isAuth","token"])),{},{filterCities:function(){var t=this;return this.searchCity?this.citiesList.filter((function(e){return-1!=e.title.toLowerCase().indexOf(t.searchCity.toLowerCase())})):_.orderBy(this.citiesList,["title"],["ASC"])}}),methods:o()(o()({},Object(p["b"])(["firebaseCommon","setFirebaseApp","getUserCategorySelected","getUserSchool","updateUserInfo","getCities"])),{},{updateCity:function(){var t=this;this.loadingCity=!0,this.updateUserInfo({city_id:this.currCity.id}).then((function(e){t.loadingCity=!1,t.dialogCities=!1,t.$set(t.userInfo,{city:t.currCity.title})}))},noUserCity:function(){this.dialogCities=!1,this.$q.localStorage.set("nullcity",!0)},isOnline:function(){this.dialogInternetConnetion=!1,this.isMounted&&this.$q.notify({html:!0,icon:"network_wifi",message:"Интернет-соединение восстановлено!"})},isOffline:function(){this.dialogInternetConnetion=!0},loadPage:function(t){var e=this;t?this.isLoadPage=t:setTimeout((function(){e.isLoadPage=t}),1e3)},initFirstData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isMounted=!1,this.getUserCategorySelected({}).then((function(s){var i=s.data;t.setCurrCat(i);var n=t.getUserCategories({}),a=t.getContacts({}),o=t.getListMailings({readed:!1}),r=t.getCoursesPurched({}),c=t.getSales({}),l=t.getUserSchool({}),u=t.$store.dispatch("loadAllInstructors"),d=t.$store.dispatch("loadSelfInstructor"),h=t.$store.dispatch("loadInstructorsOnlySignup",i);Promise.all([n,a,o,r,c,l,h,u,d]).then((function(s){t.countNewMailings=s[2].data.count,t.getClientByCategory(i),t.connectWebSocket(),t.isMounted=!0,e&&t.$router.push({path:"/dashboard"}).catch((function(t){}))})).catch((function(e){t.$router.push({path:"/logout"}).catch((function(t){}))}))}))},verifyTokenInit:function(){var t=this;this.verifyToken({token:this.token}).then((function(e){if(e.status>=400)return t.setIsAuth(!1),t.$router.push({path:"/auth"}).catch((function(t){})),void(t.isMounted=!0);200==e.status&&(t.setIsAuth(!0),t.initFirstData(!!t.notAuthRoutes.includes(t.$route.name)))}))},checkCity:function(){var t=this;"/dashboard"==this.$route.path&&(this.$q.localStorage.has("nullcity")||!this.userInfo||this.userInfo.city||this.getCities({}).then((function(e){t.dialogCities=!0,t.currCity=t.citiesList[0]})))}}),watch:{userInfo:function(t,e){if(!e){var s=this.getListLessons({});Promise.all([s]).then((function(t){})),this.checkCity()}},$route:function(t,e){this.checkCity()}},mounted:function(){var t=this;this.setOrigin("https://<production_host>"),this.setApiPrfix("/api"),this.setApipath(this.origin+this.api_prefix),this.firebaseApp||this.firebaseCommon({}).then((function(e){var s=ut.initializeApp(e.data);t.setFirebaseApp(s)}));var e=function(e){return c.a.post(t.api_path+"/token/refresh/",{refresh:t.$q.localStorage.getItem("refresh")}).then((function(s){return 400==s.status?(t.setIsAuth(!1),t.$router.push({path:"/auth"}).catch((function(t){})),void(t.isMounted=!0)):(200==s.status&&(t.$q.localStorage.set("token",s.data.access),t.$q.localStorage.set("refresh",s.data.refresh),t.setToken(s.data.access),t.setIsAuth(!0),e.response.config.headers["Authorization"]="Bearer "+s.data.access),Promise.resolve())})).catch((function(e){t.setIsAuth(!1),t.$router.push({path:"/auth"}).catch((function(t){})),t.isMounted=!0}))};h()(c.a,e,{skipAuthRefresh:!0,statusCodes:[401]}),this.$route.query.hasOwnProperty("ref_landing")&&this.$q.sessionStorage.set("ref_landing",this.$route.query.ref_landing),this.$q.localStorage.has("token")&&!this.notAuthRoutes.includes(this.$route.name)?(this.setToken(this.$q.localStorage.getItem("token")),this.verifyTokenInit()):"vk-auth"!=this.$route.name&&(this.setIsAuth(!1),this.$router.push({path:"/auth"}).catch((function(t){})),this.isMounted=!0)}},ht=dt,gt=s("27f9"),mt=s("4d5a"),pt=s("09e3"),ft=s("7ff0"),vt=s("007d"),Ct=Object(y["a"])(ht,i,n,!1,null,null,null);e["default"]=Ct.exports;B()(Ct,"components",{QIcon:$["a"],QDialog:b["a"],QCard:q["a"],QCardSection:k["a"],QItemSection:N["a"],QItemLabel:O["a"],QItem:L["a"],QMenu:A["a"],QInput:gt["a"],QList:M["a"],QBtn:w["a"],QLayout:mt["a"],QPageContainer:pt["a"],QFooter:ft["a"],QSpinnerTail:vt["a"]}),B()(Ct,"directives",{ClosePopup:Q["a"]})},b499:function(t,e,s){},f7dd:function(t,e,s){"use strict";s("b499")}}]);